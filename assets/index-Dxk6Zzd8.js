import{p as kt,m as ce,u as g,r as p,d as $,P as fs,i as ps,o as Tt,a as gs,b as xs,c as ys,e as Y,M as v,C as _s,j as e,f as ee,g as Ke,h as ae,A as js,I as bs,T as y,S as Ie,k as Ge,l as ut,n as vs,q as ws,s as Ye,t as Ss,v as Cs,w as De,B as I,x as ks,D as Ts,y as Fe,z as le,E as It,F as Is,G as Fs,H as Es,J as ht,K as Ft,L as As,N as Ee,O as Ns,Q as Et,R as te,U as Ls,V as Rs,W as Ps,X as Ds,Y as Ms,Z as W,_ as J,$ as R,a0 as mt,a1 as P,a2 as ge,a3 as G,a4 as Xe,a5 as ft,a6 as At,a7 as Os,a8 as Nt,a9 as Lt,aa as Vs,ab as ie,ac as zs,ad as Us,ae as $s,af as Bs,ag as Hs,ah as qs,ai as Ws,aj as Ks,ak as Gs,al as Ys,am as Rt,an as Pt,ao as Qe,ap as Xs,aq as Qs,ar as Js,as as Zs,at as er,au as tr,av as Me,aw as sr,ax as rr,ay as nr,az as Ae,aA as ar,aB as or,aC as ir,aD as lr,aE as cr,aF as Ue,aG as dr,aH as Dt,aI as ur,aJ as hr,aK as mr,aL as Je,aM as fr,aN as pt,aO as pr,aP as gr,aQ as xr,aR as yr,aS as _r,aT as jr,aU as br,aV as vr}from"./vendor-BwBbEY10.js";(function(){const s=document.createElement("link").relList;if(s&&s.supports&&s.supports("modulepreload"))return;for(const a of document.querySelectorAll('link[rel="modulepreload"]'))n(a);new MutationObserver(a=>{for(const i of a)if(i.type==="childList")for(const o of i.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&n(o)}).observe(document,{childList:!0,subtree:!0});function r(a){const i={};return a.integrity&&(i.integrity=a.integrity),a.referrerPolicy&&(i.referrerPolicy=a.referrerPolicy),a.crossOrigin==="use-credentials"?i.credentials="include":a.crossOrigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function n(a){if(a.ep)return;a.ep=!0;const i=r(a);fetch(a.href,i)}})();const wr="modulepreload",Sr=function(t){return"/"+t},gt={},be=function(s,r,n){let a=Promise.resolve();if(r&&r.length>0){document.getElementsByTagName("link");const o=document.querySelector("meta[property=csp-nonce]"),l=(o==null?void 0:o.nonce)||(o==null?void 0:o.getAttribute("nonce"));a=Promise.allSettled(r.map(u=>{if(u=Sr(u),u in gt)return;gt[u]=!0;const d=u.endsWith(".css"),c=d?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${u}"]${c}`))return;const h=document.createElement("link");if(h.rel=d?"stylesheet":wr,d||(h.as="script"),h.crossOrigin="",h.href=u,l&&h.setAttribute("nonce",l),document.head.appendChild(h),d)return new Promise((x,j)=>{h.addEventListener("load",x),h.addEventListener("error",()=>j(new Error(`Unable to preload CSS for ${u}`)))})}))}function i(o){const l=new Event("vite:preloadError",{cancelable:!0});if(l.payload=o,window.dispatchEvent(l),!l.defaultPrevented)throw o}return a.then(o=>{for(const l of o||[])l.status==="rejected"&&i(l.reason);return s().catch(i)})},Cr=(t,s,r)=>{const n=t[s];return n?typeof n=="function"?n():Promise.resolve(n):new Promise((a,i)=>{(typeof queueMicrotask=="function"?queueMicrotask:setTimeout)(i.bind(null,new Error("Unknown variable dynamic import: "+s+(s.split("/").length!==r?". Note that variables only represent file names one level deep.":""))))})},kr=()=>{const{language:t}=T.get(),s=Ze();return t||s},Ze=()=>{const t=navigator.language;return t==="zh-Hans-CN"?"zh-CN":t},Mt={articleWidth:90,fontFamily:"system-ui",fontSize:1.05,homePage:"all",language:Ze(),layout:"large",markReadOnScroll:!1,orderBy:"created_at",orderDirection:"desc",pageSize:100,removeDuplicates:"none",showAllFeeds:!1,showUnreadFeedsOnly:!1,showDetailedRelativeTime:!1,showFeedIcon:!0,showStatus:"unread",theme:"light",themeColor:"Blue"},T=kt("settings",Mt,{encode:JSON.stringify,decode:JSON.parse}),B=t=>T.get()[t],q=t=>T.set({...T.get(),...t}),Tr=()=>T.set(Mt),E=(t,s=null)=>r=>{const n=t.get();if(typeof n=="object"&&n!==null){if(s===null)return;typeof r=="function"?t.set({...n,[s]:r(n[s])}):t.set({...n,[s]:r})}else typeof r=="function"?t.set(r(n)):t.set(r)},O=ce({polyglot:null}),Ir=E(O,"polyglot"),Fr=async(t,s)=>{let r,n=t;try{r=await Cr(Object.assign({"../locales/en-US.json":()=>be(()=>import("./en-US-NtEBms-i.js"),[]),"../locales/es-ES.json":()=>be(()=>import("./es-ES-m7ViEL3f.js"),[]),"../locales/zh-CN.json":()=>be(()=>import("./zh-CN-CNdFjWMP.js"),[])}),`../locales/${t}.json`,3)}catch{r=await be(()=>import("./en-US-NtEBms-i.js"),[]),n="en-US"}{const a=new fs({phrases:r.default,locale:n});Ir(a)}},Ot=()=>{const{language:t}=g(T);p.useEffect(()=>{t?(Fr(t),t==="zh-CN"?$.locale("zh-cn"):t==="es"||t.startsWith("es-")?$.locale("es"):$.locale("en")):q({language:Ze()})},[t])},et=ce({addFeedModalVisible:!1,settingsModalVisible:!1}),Er=E(et,"addFeedModalVisible"),Ar=E(et,"settingsModalVisible"),tt=()=>{const{addFeedModalVisible:t,settingsModalVisible:s}=g(et);return{addFeedModalVisible:t,setAddFeedModalVisible:Er,settingsModalVisible:s,setSettingsModalVisible:Ar}},xe=()=>{const[t,s]=p.useState(window.innerWidth),r=t<=768,n=t<=992;return p.useEffect(()=>{const a=()=>s(window.innerWidth);return window.addEventListener("resize",a),()=>window.removeEventListener("resize",a)},[]),{width:t,isBelowMedium:r,isBelowLarge:n}},Vt={server:"",token:"",username:"",password:""},Oe=kt("auth",Vt,{encode:JSON.stringify,decode:JSON.parse}),zt=t=>Oe.set(t),Nr=()=>zt(Vt),Lr=t=>{try{const s=new URL(t),{hostname:r,port:n}=s;return!!r&&!!n}catch{return!1}},Ne=t=>{const{server:s,token:r,username:n,password:a}=t;return!s||!ps(s,{require_protocol:!0})&&!Lr(s)?!1:r||n&&a},Rr=()=>Tt.create({retry:3,onRequest({_request:t,options:s}){const r=Oe.get();if(!Ne(r))throw new Error("Invalid auth");const{server:n,token:a,username:i,password:o}=r;s.baseURL=n,s.headers=a?{"X-Auth-Token":a}:{Authorization:`Basic ${btoa(`${i}:${o}`)}`}},onRequestError({_request:t,_options:s,error:r}){console.error("Request error: ",r)},async onResponseError({_request:t,response:s,_options:r}){var i;s.status===401&&(localStorage.removeItem("auth"),await ms.navigate("/login"));const a=((i=s._data)==null?void 0:i.error_message)??s.statusText;throw console.error("Response error: ",a),new Error(a)}}),S=Rr();S.get=t=>S(t,{method:"GET"});S.post=(t,s)=>S(t,{method:"POST",body:s});S.put=(t,s)=>S(t,{method:"PUT",body:s});const Pr=async()=>S.get("/v1/categories"),Dr=async t=>S.post("/v1/categories",{title:t}),Mr=async t=>S.raw(`/v1/categories/${t}`,{method:"DELETE"}),Or=async(t,s,r=!1)=>{const n={title:s,hide_globally:r?"on":void 0};return S.put(`/v1/categories/${t}`,n)},Vr=async t=>S.put(`/v1/categories/${t}/mark-all-as-read`);$.extend(gs);$.extend(xs);$.extend(ys);const zr=t=>$(t).isAfter($().subtract(24,"hour")),Ur=()=>$().subtract(24,"hour").unix(),$r=()=>$().utc().format("YYYY-MM-DDTHH:mm:ss.SSSSSSZ"),Br=t=>$(t).format("dddd, MMMM D, YYYY h:mm A"),Ut=(t,s)=>{const{polyglot:r}=O.get();if(!s){const f=$(),b=$(t),k=b.from(f),w=$.duration(f.diff(b)).asSeconds();return w>=0&&w<60?r.t("date.just_now"):k}const n=$(),i=$(t).diff(n),o=$.duration(Math.abs(i)),l=o.years(),u=o.months(),d=o.days(),c=o.hours(),h=o.minutes(),x=[];if(l>0&&x.push(r.t("date.years",l)),u>0&&x.push(r.t("date.months",u)),d>0&&x.push(r.t("date.days",d)),c>0&&x.push(r.t("date.hours",c)),h>0&&x.push(r.t("date.minutes",h)),x.length===0)return r.t("date.just_now");const j=x.join(" ");return i>0?r.t("date.in_time",{time:j}):r.t("date.time_ago",{time:j})},$t=t=>{const{polyglot:s}=O.get(),r=s.t("date.minutes",t);return s.t("article_card.reading_time",{time:r})},Ve=async(t,s)=>S.put("/v1/entries",{entry_ids:t,status:s}),Hr=async t=>S.put(`/v1/entries/${t}/bookmark`),qr=async t=>S.get(`/v1/entries/${t}/fetch-content`),Wr=async t=>S.raw(`/v1/entries/${t}/save`,{method:"POST"}),de=(t,s={})=>{const{baseUrl:r,orderField:n,offset:a,limit:i,status:o}=t,l=B("orderDirection"),u=new URLSearchParams({order:n,direction:l,offset:a,limit:i,...s});return o&&u.append("status",o),`${r}?${u}`},Kr=async(t=0,s=null)=>{const r=B("orderBy"),n=B("pageSize"),a=B("showAllFeeds"),i={baseUrl:"/v1/entries",orderField:r,offset:t,limit:n,status:s},o={globally_visible:!a};return S.get(de(i,o))},ke=async(t=0,s=null,r=null)=>{const n=B("orderBy"),a=r??B("pageSize"),i=B("showAllFeeds"),o=Ur(),l={baseUrl:"/v1/entries",orderField:n,offset:t,limit:a,status:s},u={globally_visible:!i,published_after:o};return S.get(de(l,u))},Bt=async(t=0,s=null)=>{const r=B("pageSize"),n={baseUrl:"/v1/entries",orderField:"changed_at",offset:t,limit:r,status:s},a={starred:"true"};return S.get(de(n,a))},Gr=async(t=0)=>{const s=B("pageSize"),r={baseUrl:"/v1/entries",orderField:"changed_at",offset:t,limit:s,status:"read"};return S.get(de(r))},Yr=async()=>S.get("/v1/feeds"),Xr=async()=>S.get("/v1/feeds/counters"),Qr=async t=>S.raw(`/v1/feeds/${t}/refresh`,{method:"PUT"}),Jr=async()=>S.raw("/v1/feeds/refresh",{method:"PUT"}),Zr=async(t,s,r)=>S.post("/v1/feeds",{feed_url:t,category_id:s,crawler:r}),en=async t=>S.raw(`/v1/feeds/${t}`,{method:"DELETE"}),xt=async(t,s)=>{const{categoryId:r,title:n,siteUrl:a,feedUrl:i,hidden:o,disabled:l,isFullText:u}=s;return S.put(`/v1/feeds/${t}`,{category_id:r,title:n,site_url:a,feed_url:i,hide_globally:o,disabled:l,crawler:u})},tn=async t=>S.put(`/v1/feeds/${t}/mark-all-as-read`),sn=async()=>S.get("/v1/me"),rn=async t=>S.get(`/v1/icons/${t}`),nn=async()=>S.get("/v1/version"),an=async()=>{const t=await sn();return S.put(`/v1/users/${t.data.id}/mark-all-as-read`)},Ht={isAppDataReady:!1,unreadInfo:{},unreadTodayCount:0,starredCount:0,historyCount:0,feedsData:[],categoriesData:[],isVersionAtLeast2_2_0:!1},z=ce(Ht),st=Y(z,t=>{const{unreadInfo:s,feedsData:r}=t;return r.map(a=>({...a,unreadCount:s[a.id]??0})).sort((a,i)=>a.title.localeCompare(i.title,"en"))}),ye=Y([z,st],(t,s)=>{const{categoriesData:r}=t;return r.map(a=>{const i=s.filter(o=>o.category.id===a.id);return{...a,unreadCount:i.reduce((o,l)=>o+(l.unreadCount??0),0),feedCount:i.length}}).sort((a,i)=>a.title.localeCompare(i.title,"en"))}),qt=Y(ye,t=>t.filter(s=>s.hide_globally).map(s=>s.id)),rt=Y([st,qt],(t,s)=>t.filter(r=>r.hide_globally||s.includes(r.category.id)).map(r=>r.id)),Wt=Y([st,rt,T],(t,s,r)=>{const{showAllFeeds:n}=r;return t.filter(a=>n||!s.includes(a.id))}),on=Y([ye,qt,T],(t,s,r)=>{const{showAllFeeds:n}=r;return t.filter(a=>n||!s.includes(a.id))}),Kt=Y(Wt,t=>t.reduce((s,r)=>{const{id:n}=r.category;return s[n]||(s[n]=[]),s[n].push(r),s},{})),ln=Y([z,Wt],(t,s)=>{const{unreadInfo:r}=t;return Object.entries(r).reduce((n,[a,i])=>s.some(o=>o.id===Number(a))?n+i:n,0)}),Te=E(z,"categoriesData"),re=E(z,"feedsData"),$e=E(z,"historyCount"),yt=E(z,"isAppDataReady"),Be=E(z,"starredCount"),Gt=E(z,"unreadInfo"),Yt=E(z,"unreadTodayCount"),cn=E(z,"isVersionAtLeast2_2_0"),dn=()=>z.set(Ht),Xt=(t,s)=>{const r=s.map(n=>n.id);return t.map(n=>r.includes(n.id)&&s.find(i=>i.id===n.id)||n)},He=(t,s)=>{const r={};let n=0;const a=t.filter(d=>d.status!==s);if(a.length===0)return;const{showStatus:i}=T.get();s==="read"?($e(d=>d+a.length),i==="unread"&&Pe(d=>d-a.length)):($e(d=>Math.max(0,d-a.length)),i==="unread"&&Pe(d=>d+a.length));for(const d of a){const c=d.feed.id,h=zr(d.published_at),x=s==="read"?-1:1;r[c]=(r[c]??0)+x,n+=h?x:0}Yt(d=>Math.max(0,d+n)),Gt(d=>{const c={...d};for(const[h,x]of Object.entries(r))c[h]=Math.max(0,(c[h]??0)+x);return c});const o=a.map(d=>({...d,status:s})),{activeContent:l}=N.get(),u=o.find(d=>d.id===(l==null?void 0:l.id));u&&Z(u),_e(d=>Xt(d,o))},nt=()=>{const{activeContent:t}=g(N),{polyglot:s}=g(O),r=(u,d)=>{He([u],d)},n=(u,d)=>{d?(Be(h=>h+1),_s({particleCount:100,angle:120,spread:70,origin:{x:1,y:1}})):Be(h=>Math.max(0,h-1));const c={...u,starred:d};t&&Z(c),_e(h=>Xt(h,[c]))};return{handleEntryStatusUpdate:r,handleFetchContent:async()=>{try{const u=await qr(t.id);v.success(s.t("actions.fetched_content_success")),Z({...t,content:u.content})}catch{v.error(s.t("actions.fetched_content_error"))}},handleSaveToThirdPartyServices:async()=>{try{(await Wr(t.id)).status===202?v.success(s.t("actions.saved_to_third-party_services_success")):v.error(s.t("actions.saved_to_third-party_services_error"))}catch{v.error(s.t("actions.saved_to_third-party_services_error"))}},handleToggleStarred:async u=>{const d=!u.starred;n(u,d),Hr(u.id).catch(()=>{v.error(d?s.t("actions.star_error"):s.t("actions.unstar_error")),n(u,!d)})},handleToggleStatus:async u=>{const d=u.status,c=d==="read"?"unread":"read";r(u,c),Ve([u.id],c).catch(()=>{v.error(c==="read"?s.t("actions.mark_as_read_error"):s.t("actions.mark_as_unread_error")),r(u,d)})}}},un=(t,s)=>{const{polyglot:r}=O.get();if(t.length===0||s==="none")return t;const n=t.map((c,h)=>({id:c.id,index:h})),a=new Map,i=new Map,o=new Map,l=[],u=t.slice().sort((c,h)=>c.id-h.id).filter(c=>{const{hash:h,title:x,url:j,id:f}=c;switch(s){case"hash":if(a.has(h))return l.push(c),!1;a.set(h,f);break;case"title":if(i.has(x))return l.push(c),!1;i.set(x,f);break;case"url":if(o.has(j))return l.push(c),!1;o.set(j,f);break;default:return!0}return!0}),d=l.filter(c=>c.status==="unread").map(c=>c.id);return d.length>0&&(He(l,"read"),Ve(d,"read").catch(()=>{v.error(r.t("deduplicate.mark_as_read_error")),He(l,"unread")})),u.sort((c,h)=>{const x=n.find(f=>f.id===c.id).index,j=n.find(f=>f.id===h.id).index;return x-j})},hn=t=>{const s=new Array(t.length).fill(0);let r=0,n=1;for(;n<t.length;)t[n]===t[r]?(r++,s[n]=r,n++):r!==0?r=s[r-1]:(s[n]=0,n++);return s},ve=(t,s,r=!0)=>{const n=r?t.toLowerCase():t,a=r?s.toLowerCase():s;if(a.length===0)return 0;const i=hn(a);let o=0,l=0;for(;o<n.length;)if(n[o]===a[l]?(o++,l++):l!==0?l=i[l-1]:o++,l===a.length)return o-l;return-1},mn=t=>{const s=[],r=[];let n=[];const a=[],i=t.match(/([-+|]?)\s*"([^"]+)"/g);let o=t;i&&(n=i.map(u=>{const d=u.trim()[0],c=u.match(/"([^"]+)"/)[1];switch(d){case"-":r.push(c);break;case"+":s.push(c);break;case"|":a.push([c]);break;default:s.push(c);break}return c}),o=t.replace(/([-+|]?)\s*"([^"]+)"/g,""));const l=o.split(/\s+/);for(const u of l){const d=u.replace(/^-|\+|\|$/,"");if(u.startsWith("-")&&d)r.push(d);else if(u.startsWith("+")&&d)s.push(d);else if(u.includes("|")){const c=u.split("|").filter(h=>h);c.length>0&&a.push(c)}else d&&s.push(d)}return{includeTerms:s,excludeTerms:r,exactPhrases:n,orConditions:a}},fn=(t,s,r=[],n=!0)=>{const{includeTerms:a,excludeTerms:i,exactPhrases:o,orConditions:l}=mn(s);return t.filter(u=>r.some(d=>{const c=u[d];if(typeof c!="string")return!1;const h=n?c.toLowerCase():c;if(i.some(f=>ve(h,f,n)!==-1)||o.length>0&&!o.some(f=>ve(h,f,n)!==-1))return!1;const x=a.every(f=>ve(h,f,n)!==-1),j=l.length===0||l.some(f=>f.some(b=>ve(h,b,n)!==-1));return x&&j}))},Qt=(t,s,r=[],n=!0)=>!Array.isArray(t)||t.length===0?(console.error("Invalid data input:",{receivedData:t,type:typeof t,isArray:Array.isArray(t),length:Array.isArray(t)?t.length:"N/A"}),[]):typeof s!="string"||s.trim().length===0?(console.error("Invalid query input:",{receivedQuery:s,type:typeof s,trimmedLength:typeof s=="string"?s.trim().length:"N/A"}),[]):fn(t,s,r,n),pn=(t,s)=>t.toLowerCase().includes(s.toLowerCase()),gn=(t,s,r)=>r?Qt(t,r,[s]):t,Jt={activeContent:null,entries:[],filterString:"",filterType:"Title",infoFrom:B("homePage"),isArticleFocused:!1,isArticleListReady:!1,loadMoreVisible:!1,offset:0,total:0},N=ce(Jt),ze=Y([N,z,rt,T],(t,s,r,n)=>{const{entries:a,filterString:i,filterType:o,infoFrom:l}=t,u=gn(a,o,i),{isVersionAtLeast2_2_0:d}=s,{removeDuplicates:c,showAllFeeds:h}=n,x=!["starred","history"].includes(l),j=b=>d||h||!r.includes(b.feed.id),f=x?u.filter(j):u;return c==="none"||["starred","history"].includes(l)?f:un(f,c)}),Z=E(N,"activeContent"),_e=E(N,"entries"),Le=E(N,"filterString"),Re=E(N,"filterType"),xn=E(N,"infoFrom"),ne=E(N,"isArticleFocused"),_t=E(N,"isArticleListReady"),Zt=E(N,"loadMoreVisible"),Pe=E(N,"offset"),yn=E(N,"total"),_n=()=>N.set(Jt),jt=ce(),we=new Set,jn=t=>{const s=g(jt);return p.useEffect(()=>{s[t]||we.has(t)||(we.add(t),rn(t).then(r=>{const n=`data:${r.data}`;jt.setKey(t,n),we.delete(t)}).catch(()=>{we.delete(t)}))},[t,s]),s[t]},bn=t=>{const s=/^(?:http|https):\/\/((?!(\d+\.){3}\d+)([^/?#]+))/,r=t.match(s);return r?r[1]:null},bt=t=>{const s=bn(t);if(s){const r=s.split(".");if(r.length>=2)return r.slice(-2).join(".")}return null},vn=t=>`https://icons.duckduckgo.com/ip3/${bt(t.site_url)??bt(t.feed_url)}.ico`,es=({feed:t,className:s="feed-icon"})=>{const{icon_id:r}=t.icon,n=vn(t);if(r===0)return e.jsx("img",{className:s,src:n,alt:""});const[a,i]=p.useState(n),o=jn(r);return p.useEffect(()=>{o&&i(o)},[o]),e.jsx("img",{className:s,src:a,alt:"",onError:()=>i(n)})},ts=ee.Item,wn=({category:t,path:s})=>{var o;const n=(o=g(Kt)[t.id])==null?void 0:o.reduce((l,u)=>l+u.unreadCount,0),a=ae(),i=()=>{a(`/category/${t.id}`),Z(null)};return e.jsxs("div",{className:De("category-title",{"submenu-active":s===`/category/${t.id}`,"submenu-inactive":s!==`/category/${t.id}`}),onClick:i,onKeyDown:l=>{(l.key==="Enter"||l.key===" ")&&i()},tabIndex:0,role:"button",style:{cursor:"pointer"},children:[e.jsx(y.Ellipsis,{expandable:!1,showTooltip:!0,style:{width:n?"80%":"100%",fontWeight:500},children:t.title}),n>0&&e.jsx(y.Ellipsis,{className:"unread-count",expandable:!1,style:{fontWeight:500},children:n})]})},Sn=({count:t})=>e.jsx(y.Ellipsis,{className:"item-count",expandable:!1,children:t||""}),Se=({path:t,Icon:s,label:r,count:n})=>{const a=Ke(),i=ae(),o=a.pathname===t,l=()=>{i(t),Z(null)};return e.jsx(ts,{onClick:l,className:De("arco-menu-item",{"arco-menu-selected":o}),children:e.jsxs("div",{className:"custom-menu-item",children:[e.jsxs("span",{children:[e.jsx(s,{}),r]}),e.jsx(Sn,{count:n})]})},t)},ss=()=>{const{homePage:t,showFeedIcon:s,showUnreadFeedsOnly:r}=g(T),{historyCount:n,isAppDataReady:a,starredCount:i,unreadTodayCount:o}=g(z),l=g(Kt),u=g(on),d=g(ln),{polyglot:c}=g(O),h=Ke(),x=ae(),[j,f]=p.useState([`/${t}`]),b=h.pathname;p.useEffect(()=>{f([b])},[b]);const k=()=>e.jsxs(e.Fragment,{children:[e.jsx(Se,{path:"/all",Icon:vs,label:c.t("sidebar.all"),count:d}),e.jsx(Se,{path:"/today",Icon:ws,label:c.t("sidebar.today"),count:o}),e.jsx(Se,{path:"/starred",Icon:Ye,label:c.t("sidebar.starred"),count:i}),e.jsx(Se,{path:"/history",Icon:Ss,label:c.t("sidebar.history"),count:n})]}),w=C=>{var H;return(H=l[C])==null?void 0:H.filter(D=>!r||D.unreadCount>0).map(D=>e.jsx(ts,{style:{position:"relative",overflow:"hidden"},onClick:X=>{X.stopPropagation(),x(`/feed/${D.id}`),Z(null)},children:e.jsxs("div",{className:"custom-menu-item",children:[e.jsxs(y.Ellipsis,{expandable:!1,showTooltip:!0,style:{width:D.unreadCount?"80%":"100%",paddingLeft:"20px",boxSizing:"border-box"},children:[s&&e.jsx(es,{feed:D,className:"feed-icon-sidebar"}),D.title]}),D.unreadCount!==0&&e.jsx(y.Ellipsis,{className:"item-count",expandable:!1,children:D.unreadCount})]})},`/feed/${D.id}`))},L=()=>u.filter(C=>!r||C.unreadCount>0).map(C=>e.jsx(ut.Item,{name:`/category/${C.id}`,style:{position:"relative",overflow:"hidden"},header:e.jsx(wn,{category:C,path:b}),expandIcon:e.jsx(Cs,{}),children:w(C.id)},C.id));return e.jsxs("div",{className:"sidebar-container",children:[e.jsxs(ee,{hasCollapseButton:!1,selectedKeys:j,children:[e.jsxs("div",{className:"menu-header",children:[e.jsx(js,{className:"avatar",size:32,children:e.jsx(bs,{style:{color:"var(--color-bg-1)"}})}),e.jsx(y.Title,{heading:6,style:{margin:0},children:"ReactFlux"})]}),e.jsx(y.Title,{className:"section-title",heading:6,style:{paddingLeft:"12px"},children:c.t("sidebar.articles")}),e.jsx(Ie,{loading:!a,animation:!0,text:{rows:3}}),a&&k(),e.jsx(y.Title,{className:"section-title",heading:6,style:{paddingLeft:"12px"},children:c.t("sidebar.feeds")})]}),e.jsx("div",{className:"feeds-menu-wrapper",children:e.jsx(Ge,{style:{maxHeight:"100%"},autoHide:!0,children:e.jsxs(ee,{autoScrollIntoView:!0,hasCollapseButton:!1,selectedKeys:j,children:[e.jsx(Ie,{loading:!a,animation:!0,text:{rows:6}}),a&&e.jsx(ut,{triggerRegion:"icon",bordered:!1,children:L()})]})})})]})},Cn=()=>{const{showAllFeeds:t,theme:s}=g(T),{polyglot:r}=g(O),n=[{label:r.t("header.theme_option_light"),value:"light"},{label:r.t("header.theme_option_dark"),value:"dark"},{label:r.t("header.theme_option_system"),value:"system"}],a=ae(),i=Ke().pathname,{setAddFeedModalVisible:o,setSettingsModalVisible:l}=tt(),{isBelowLarge:u}=xe(),[d,c]=p.useState(!1),[h,x]=p.useState(!1),[j,f]=p.useState(!1);p.useEffect(()=>{u||c(!1)},[u]),p.useEffect(()=>{i&&c(!1)},[i]);const b=()=>{q({showAllFeeds:!t})},k=()=>{q({theme:s==="light"?"dark":"light"})},w=()=>{Tr(),x(!1)},L=()=>{Nr(),_n(),dn(),a("/login"),v.success(r.t("header.logout_success"))},C=()=>s==="dark"?e.jsx(Ls,{}):s==="system"?e.jsx(Rs,{}):e.jsx(Ps,{});return e.jsxs("div",{className:"header",children:[e.jsx("div",{className:"brand",children:e.jsx(I,{className:"trigger",onClick:()=>c(!d),shape:"circle",size:"small",children:e.jsx(ks,{})})}),e.jsx(Ts,{className:"sidebar-drawer",visible:d,title:null,footer:null,closable:!1,onCancel:()=>c(!1),placement:"left",width:240,children:e.jsx(ss,{})}),e.jsx("div",{className:"button-group",children:e.jsxs(Fe,{size:16,children:[e.jsx(le,{content:r.t("header.add_feed"),mini:!0,children:e.jsx(I,{shape:"circle",size:"small",type:"primary",icon:e.jsx(It,{}),onClick:()=>o(!0)})}),e.jsx(le,{content:t?r.t("header.hide_some_feeds"):r.t("header.show_all_feeds"),mini:!0,children:e.jsx(I,{shape:"circle",size:"small",icon:t?e.jsx(Is,{}):e.jsx(Fs,{}),onClick:b})}),e.jsx(I,{shape:"circle",size:"small",icon:e.jsx(Es,{}),onClick:()=>window.open("https://github.com/electh/ReactFlux","_blank")}),e.jsx(ht,{droplist:e.jsx(ee,{defaultSelectedKeys:[s],className:"theme-menu",children:n.map(({label:H,value:D})=>e.jsxs(ee.Item,{className:"theme-menu-item",onClick:()=>q({theme:D}),children:[H,s===D&&e.jsx(Ft,{style:{marginLeft:8}})]},D))}),children:e.jsx(I,{icon:C(),shape:"circle",size:"small",onClick:k})}),e.jsx(ht,{droplist:e.jsxs(ee,{children:[e.jsxs(ee.Item,{onClick:()=>l(!0),children:[e.jsx(As,{className:"icon-right"}),r.t("header.settings")]},"0"),e.jsxs(ee.Item,{onClick:()=>x(!0),children:[e.jsx(Ee,{className:"icon-right"}),r.t("header.reset_settings")]},"1"),e.jsxs(ee.Item,{onClick:()=>f(!0),children:[e.jsx(Ns,{className:"icon-right"}),r.t("header.logout")]},"2")]}),trigger:"click",children:e.jsx(I,{icon:e.jsx(Et,{}),shape:"circle",size:"small"})})]})}),e.jsx(te,{title:r.t("header.settings_reset_confirm"),visible:h,onOk:w,onCancel:()=>x(!1),children:e.jsx("p",{children:r.t("header.settings_reset_description")})}),e.jsx(te,{title:r.t("header.logout_confirm"),visible:j,onOk:L,onCancel:()=>f(!1),children:e.jsx("p",{children:r.t("header.logout_description")})})]})},kn=(t,s)=>{const r=t.split("."),n=s.split(".");for(let a=0;a<Math.max(r.length,n.length);a++){const i=r[a]||"0",o=n[a]||"0",l=i.localeCompare(o,void 0,{numeric:!0});if(l!==0)return l}return 0},at=()=>{const t=p.useRef(!1);return{fetchAppData:async()=>{if(!t.current){t.current=!0,yt(!1);try{const r=await Promise.all([Xr(),ke(0,"unread"),Bt(),Yr(),Pr(),nn()]),[n,a,i,o,l,u]=r,d=o.reduce((h,x)=>(h[x.id]=n.unreads[x.id]??0,h),{}),c=Object.values(n.reads).reduce((h,x)=>h+x,0);Gt(d),Yt(a.total??0),Be(i.total??0),$e(c),re(o),Te(l),cn(kn(u.version,"2.2.0")>=0),yt(!0)}catch(r){console.error("Error fetching app data: ",r)}finally{t.current=!1}}}}},qe={Red:{light:"#F53F3F",dark:"#F76965"},Orange:{light:"#F77234",dark:"#F9925A"},Gold:{light:"#F7BA1E",dark:"#F9CC44"},Green:{light:"#00B42A",dark:"#27C346"},Cyan:{light:"#14C9C9",dark:"#3FD4CF"},Blue:{light:"#165DFF",dark:"#3C7EFF"},Purple:{light:"#722ED1",dark:"#8E51DA"},Magenta:{light:"#F5319D",dark:"#F756A9"}},We=t=>{const s=qe[t]||qe.Blue,r=window.matchMedia("(prefers-color-scheme: dark)").matches,n=B("theme");return(n==="system"?r:n==="dark")?s.dark:s.light},rs=t=>{Ds(We(t),{list:!0}).map(Ms).forEach((r,n)=>{document.body.style.setProperty(`--primary-${n+1}`,r)})},Tn=()=>{const{articleWidth:t,fontSize:s,fontFamily:r,layout:n,showDetailedRelativeTime:a,showFeedIcon:i,themeColor:o}=g(T),{polyglot:l}=g(O),u=[{label:l.t("appearance.font_family_system"),value:"system-ui"},{label:"Sans-serif",value:"sans-serif"},{label:"Serif",value:"serif"},{label:"Fira Sans",value:"'Fira Sans', sans-serif"},{label:"Open Sans",value:"'Open Sans', sans-serif"},{label:"Source Sans Pro",value:"'Source Sans Pro', sans-serif"},{label:"Source Serif Pro",value:"'Source Serif Pro', serif"},{label:l.t("appearance.font_family_noto_sans"),value:"'Noto Sans SC', sans-serif"},{label:l.t("appearance.font_family_noto_serif"),value:"'Noto Serif SC', serif"},{label:l.t("appearance.font_family_lxgw_wenkai"),value:"'LXGW WenKai Screen', sans-serif"}],d=c=>{q(c),c.themeColor&&rs(c.themeColor)};return e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"setting-row",children:[e.jsxs("div",{children:[e.jsx(y.Title,{heading:6,style:{marginTop:0},children:l.t("appearance.theme_color_label")}),e.jsx(y.Text,{type:"secondary",children:l.t("appearance.theme_color_description")})]}),e.jsx("div",{style:{display:"flex"},children:Object.keys(qe).map(c=>e.jsx("div",{style:{width:"18px",height:"18px",borderRadius:"50%",margin:"2px",backgroundColor:We(c),cursor:"pointer",border:"3px solid var(--color-bg-3)",outline:c===o?`1px solid ${We(c)}`:"none"},onClick:()=>d({themeColor:c}),onKeyDown:h=>{(h.key==="Enter"||h.key===" ")&&d({themeColor:c})},"aria-label":l.t("appearance.theme_color_aria_label",{color:c})},c))})]}),e.jsx(W,{}),e.jsxs("div",{className:"setting-row",children:[e.jsxs("div",{children:[e.jsx(y.Title,{heading:6,style:{marginTop:0},children:l.t("appearance.compact_article_list_label")}),e.jsx(y.Text,{type:"secondary",children:l.t("appearance.compact_article_list_description")})]}),e.jsx("div",{children:e.jsx(J,{checked:n==="small",onChange:c=>d({layout:c?"small":"large"})})})]}),e.jsx(W,{}),e.jsxs("div",{className:"setting-row",children:[e.jsxs("div",{children:[e.jsx(y.Title,{heading:6,style:{marginTop:0},children:l.t("appearance.show_detailed_relative_time_label")}),e.jsx(y.Text,{type:"secondary",children:l.t("appearance.show_detailed_relative_time_description")})]}),e.jsx("div",{children:e.jsx(J,{checked:a,onChange:c=>d({showDetailedRelativeTime:c})})})]}),e.jsx(W,{}),e.jsxs("div",{className:"setting-row",children:[e.jsxs("div",{children:[e.jsx(y.Title,{heading:6,style:{marginTop:0},children:l.t("appearance.show_feed_icon_label")}),e.jsx(y.Text,{type:"secondary",children:l.t("appearance.show_feed_icon_description")})]}),e.jsx("div",{children:e.jsx(J,{checked:i,onChange:c=>d({showFeedIcon:c})})})]}),e.jsx(W,{}),e.jsxs("div",{className:"setting-row",children:[e.jsxs("div",{children:[e.jsx(y.Title,{heading:6,style:{marginTop:0},children:l.t("appearance.font_family_label")}),e.jsx(y.Text,{type:"secondary",children:l.t("appearance.font_family_description")})]}),e.jsx("div",{children:e.jsx(R,{style:{width:166},value:r,onChange:c=>d({fontFamily:c}),children:u.map(({label:c,value:h})=>e.jsx(R.Option,{value:h,children:c},h))})})]}),e.jsx(W,{}),e.jsxs("div",{className:"setting-row",children:[e.jsxs("div",{children:[e.jsx(y.Title,{heading:6,style:{marginTop:0},children:l.t("appearance.font_size_label")}),e.jsx(y.Text,{type:"secondary",children:l.t("appearance.font_size_description")})]}),e.jsx("div",{children:e.jsxs(Fe,{children:[e.jsx(y.Text,{style:{fontSize:"0.75rem"},children:"A"}),e.jsx(mt,{formatTooltip:c=>`${c}rem`,max:1.25,min:.75,showTicks:!0,step:.05,style:{width:200},value:s,onChange:c=>d({fontSize:c})}),e.jsx(y.Text,{style:{fontSize:"1.25rem"},children:"A"})]})})]}),e.jsx(W,{}),e.jsxs("div",{className:"setting-row",children:[e.jsxs("div",{children:[e.jsx(y.Title,{heading:6,style:{marginTop:0},children:l.t("appearance.article_width_label")}),e.jsx(y.Text,{type:"secondary",children:l.t("appearance.article_width_description")})]}),e.jsx("div",{children:e.jsxs(Fe,{children:[e.jsx(y.Text,{children:"60%"}),e.jsx(mt,{formatTooltip:c=>`${c}%`,max:90,min:60,showTicks:!0,step:10,style:{width:160},value:t,onChange:c=>d({articleWidth:c})}),e.jsx(y.Text,{children:"90%"})]})})]})]})},In=()=>{const t=g(ye),{polyglot:s}=g(O),[r]=P.useForm(),[n,a]=p.useState(!1),[i,o]=p.useState(""),[l,u]=p.useState({}),[d,c]=p.useState(!1),h=async()=>{if(i.trim()){try{const f=await Dr(i);Te(b=>[...b,{...f}]),v.success(s.t("category_list.add_category_success"))}catch(f){console.error(`${s.t("category_list.add_category_error")}: `,f),v.error(s.t("category_list.add_category_error"))}o(""),c(!1)}},x=async(f,b,k)=>{try{const w=await Or(f,b,k);re(L=>L.map(C=>C.category.id===f?{...C,category:{...C.category,title:b,hide_globally:k}}:C)),Te(L=>L.map(C=>C.id===f?{...C,...w}:C)),v.success(s.t("category_list.update_category_success"))}catch{v.error(s.t("category_list.update_category_error"))}a(!1),r.resetFields()},j=async f=>{try{(await Mr(f.id)).status===204?(Te(k=>k.filter(w=>w.id!==f.id)),v.success(s.t("category_list.remove_category_success",{title:f.title}))):v.error(s.t("category_list.remove_category_error",{title:f.title}))}catch(b){console.error(s.t("category_list.remove_category_error",{title:f.title}),b),v.error(s.t("category_list.remove_category_error",{title:f.title}))}};return e.jsxs(e.Fragment,{children:[e.jsxs("div",{children:[t.map(f=>e.jsx(ge,{className:"tag-style",closable:f.feedCount===0,size:"medium",onClick:()=>{u(f),a(!0),r.setFieldsValue({title:f.title})},onClose:async b=>{b.stopPropagation(),await j(f)},children:f.title},f.id)),d?e.jsx(G,{autoFocus:!0,className:"input-style",onBlur:h,onChange:o,onPressEnter:h,size:"small",value:i}):e.jsx(ge,{className:"add-category-tag",icon:e.jsx(It,{}),onClick:()=>c(!0),size:"medium",tabIndex:0})]}),l&&e.jsx(te,{className:"modal-style",onOk:r.submit,title:"Edit Category",unmountOnExit:!0,visible:n,onCancel:()=>{a(!1),r.resetFields()},children:e.jsxs(P,{form:r,layout:"vertical",onSubmit:f=>x(l.id,f.title,f.hidden),labelCol:{style:{flexBasis:90}},wrapperCol:{style:{flexBasis:"calc(100% - 90px)"}},children:[e.jsx(P.Item,{label:"Title",field:"title",rules:[{required:!0}],children:e.jsx(G,{placeholder:"Please input category title"})}),e.jsx(P.Item,{label:"Hidden",field:"hidden",initialValue:l.hide_globally,triggerPropName:"checked",rules:[{type:"boolean"}],children:e.jsx(J,{})})]})})]})},Fn=t=>new Promise(s=>setTimeout(s,t)),En=(t,s,r=!1)=>{let n;return function(...a){const i=()=>{n=null,r||t.apply(this,a)},o=r&&!n;clearTimeout(n),n=setTimeout(i,s),o&&t.apply(this,a)}},ns=Xe(""),vt=E(ns),ot=Xe("title"),An=E(ot),as=Y([z,ns,ot],(t,s,r)=>{const{feedsData:n}=t,a=[...n].sort((i,o)=>i.disabled&&!o.disabled?1:!i.disabled&&o.disabled?-1:0).sort((i,o)=>o.parsing_error_count-i.parsing_error_count);return s?Qt(a,s,[r]):a}),Nn=Y(as,t=>t.map(s=>({category:s.category,checked_at:s.checked_at,crawler:s.crawler,disabled:s.disabled,feed_url:s.feed_url,hidden:s.hide_globally,key:s.id,parsing_error_count:s.parsing_error_count,site_url:s.site_url,title:s.title}))),wt=(t,s,r=null)=>r===null||r===t.id?{...t,parsing_error_count:s?0:t.parsing_error_count+1,checked_at:$r()}:t,Ln=()=>{const t=g(ye),{isAppDataReady:s}=g(z),{showDetailedRelativeTime:r}=g(T),n=g(as),a=g(ot),i=g(Nn),{polyglot:o}=g(O),l=o.t("search.tooltip").split(`
`),[u,d]=p.useState(!1),[c]=P.useForm(),[h,x]=p.useState(!1),[j,f]=p.useState(""),[b,k]=p.useState(null),{isBelowMedium:w}=xe();p.useEffect(()=>{vt("")},[]);const L=m=>{k(m),x(!0),c.setFieldsValue({category:m.category.id,title:m.title,siteUrl:m.site_url,feedUrl:m.feed_url,hidden:m.hidden,disabled:m.disabled,crawler:m.crawler})},C=async(m,_,F=!0)=>{try{const M=(await m()).status===204;return F&&(M?v.success(o.t("feed_table.refresh_success")):v.error(o.t("feed_table.refresh_error"))),re(se=>se.map(oe=>_(oe,M))),M}catch{return F&&v.error(o.t("feed_table.refresh_error")),re(M=>M.map(se=>_(se,!1))),!1}},H=async(m,_=!0)=>{const F=m.id||m.key;return C(()=>Qr(F),(V,M)=>wt(V,M,F),_)},D=async()=>{try{const m=await Promise.all(n.map(async _=>{const F=new URL(_.feed_url).hostname;if(F===j)return _;const V=_.feed_url.replace(F,j),M=await xt(_.id,{feedUrl:V});return{..._,...M}}));re(_=>_.map(F=>m.find(V=>V.id===F.id)||F)),v.success(o.t("feed_table.bulk_update_success")),d(!1)}catch{v.error(o.t("feed_table.bulk_update_error"))}},X=()=>{const[m,_]=p.useState(!1),F=async()=>{_(!1),await C(Jr,wt)},V=async()=>{_(!1);const se=n.filter(he=>he.parsing_error_count>0);v.success(o.t("feed_table.bulk_refresh_error_feeds_message"));let oe=0,je=0;for(const he of se)await H(he,!1)?oe++:je++,await Fn(500);v.success(o.t("feed_table.bulk_refresh_error_feeds_result",{success:oe,failure:je}))},M=()=>_(!1);return e.jsxs(e.Fragment,{children:[e.jsx(I,{icon:e.jsx(Ee,{}),shape:"circle",size:"small",onClick:()=>_(!0)}),e.jsx(te,{className:"edit-modal",onCancel:M,title:o.t("feed_table.refresh_feeds_title"),visible:m,footer:[e.jsx(I,{onClick:M,children:o.t("feed_table.refresh_feeds_cancel")},"cancel"),e.jsx(I,{type:"outline",onClick:V,children:o.t("feed_table.refresh_feeds_error")},"error"),e.jsx(I,{type:"primary",onClick:F,children:o.t("feed_table.refresh_feeds_all")},"all")],children:e.jsx("p",{children:o.t("feed_table.refresh_feeds_description")})})]})},A=async m=>{try{(await en(m.key)).status===204?(re(F=>F.filter(V=>V.id!==m.key)),v.success(o.t("feed_table.remove_feed_success",{title:m.title}))):v.error(o.t("feed_table.remove_feed_error",{title:m.title}))}catch(_){console.error(`Failed to unfollow feed: ${m.title}`,_),v.error(o.t("feed_table.remove_feed_error",{title:m.title}))}},U=[{title:o.t("feed_table.table_title"),dataIndex:"title",sorter:(m,_)=>m.title.localeCompare(_.title,"en"),render:(m,_)=>{const F=_.parsing_error_count;let V=_.disabled?`ðŸš« ${m}`:m;F>0&&(V=`âš ï¸ ${m}`);const M=e.jsxs("div",{children:[m,F>0&&e.jsxs(e.Fragment,{children:[e.jsx("br",{}),"âš ï¸ Parsing error count: ",F]})]});return e.jsx(y.Ellipsis,{expandable:!1,children:e.jsx(le,{mini:!0,content:M,children:V})})}},!w&&{title:o.t("feed_table.table_url"),dataIndex:"feed_url",sorter:(m,_)=>m.feed_url.localeCompare(_.feed_url,"en"),render:m=>e.jsx(y.Ellipsis,{expandable:!1,showTooltip:!0,children:m})},{title:o.t("feed_table.table_category"),dataIndex:"category.title",sorter:(m,_)=>m.category.title.localeCompare(_.category.title,"en"),render:m=>e.jsx(y.Ellipsis,{expandable:!1,showTooltip:!0,children:e.jsx(ge,{children:m})})},!w&&{title:o.t("feed_table.table_checked_at"),dataIndex:"checked_at",sorter:(m,_)=>m.checked_at.localeCompare(_.checked_at,"en"),render:m=>e.jsx(y.Ellipsis,{expandable:!1,children:Ut(m,r)})},{title:o.t("feed_table.table_actions"),dataIndex:"op",fixed:"right",width:100,render:(m,_)=>e.jsxs(Fe,{children:[e.jsx("button",{"aria-label":o.t("feed_table.table_feed_edit_label"),className:"list-item-action",onClick:()=>L(_),type:"button",children:e.jsx(ft,{})}),e.jsx("button",{"aria-label":o.t("feed_table.table_feed_refresh_label"),className:"list-item-action",onClick:()=>H(_),type:"button",children:e.jsx(Ee,{})}),e.jsx(At,{focusLock:!0,position:"left",title:o.t("feed_table.table_feed_remove_confirm"),onOk:()=>A(_),children:e.jsx("span",{className:"list-item-action",children:e.jsx(Os,{})})})]})}].filter(Boolean),K=async(m,_)=>{try{const F=await xt(m,_);re(V=>V.map(M=>M.id===m?{...M,...F}:M)),v.success(o.t("feed_table.update_feed_success")),x(!1),c.resetFields()}catch{v.error(o.t("feed_table.update_feed_error"))}};return e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"feed-table-action-bar",children:[e.jsx("div",{style:{display:"flex",flex:1,justifyContent:"center",minWidth:0},children:e.jsx(G.Search,{allowClear:!0,className:"search-input",onChange:vt,placeholder:o.t("search.placeholder"),addBefore:e.jsxs(R,{onChange:An,style:{width:126},value:a,children:[e.jsx(R.Option,{value:"title",children:o.t("search.type_title")}),e.jsx(R.Option,{value:"feed_url",children:o.t("search.type_feed_url")}),e.jsx(R.Option,{value:"site_url",children:o.t("search.type_site_url")})]})})}),e.jsxs("div",{className:"button-group",children:[e.jsx(le,{mini:!0,position:"bottom",content:e.jsx("div",{children:l.map((m,_)=>e.jsxs(p.Fragment,{children:[m,_<l.length-1&&e.jsx("br",{})]},`line-${_}-${m.length}`))}),children:e.jsx(I,{shape:"circle",size:"small",icon:e.jsx(Nt,{})})}),e.jsx(I,{icon:e.jsx(ft,{}),shape:"circle",size:"small",onClick:()=>d(!0)}),e.jsxs(te,{className:"edit-modal",onOk:D,title:o.t("feed_table.modal_bulk_update_title"),visible:u,onCancel:()=>{d(!1),f("")},children:[e.jsx("p",{children:o.t("feed_table.modal_bulk_update_description")}),e.jsx(G,{placeholder:"rsshub.app",value:j,onChange:m=>f(m)})]}),e.jsx(X,{})]})]}),e.jsx(Lt,{borderCell:!0,className:"feed-table",columns:U,data:i,loading:!s,pagePosition:"bottomCenter",scroll:{x:!0},size:"small"}),b&&e.jsx(te,{className:"edit-modal",onOk:c.submit,title:o.t("feed_table.modal_edit_feed_title"),unmountOnExit:!0,visible:h,onCancel:()=>{x(!1),c.resetFields()},children:e.jsxs(P,{form:c,labelCol:{span:7},layout:"vertical",wrapperCol:{span:17},onSubmit:async m=>{const _={categoryId:m.category,title:m.title,siteUrl:m.siteUrl.trim(),feedUrl:m.feedUrl.trim(),hidden:m.hidden,disabled:m.disabled,isFullText:m.crawler};_.feedUrl?await K(b.key,_):v.error(o.t("feed_table.modal_edit_feed_submit_error"))},children:[e.jsx(P.Item,{label:o.t("feed_table.modal_edit_feed_category_label"),required:!0,field:"category",rules:[{required:!0}],children:e.jsx(R,{children:t.map(m=>e.jsx(R.Option,{value:m.id,children:m.title},m.id))})}),e.jsx(P.Item,{label:o.t("feed_table.modal_edit_feed_title_label"),field:"title",rules:[{required:!0}],children:e.jsx(G,{placeholder:o.t("feed_table.modal_edit_feed_title_placeholder")})}),e.jsx(P.Item,{label:o.t("feed_table.modal_edit_feed_site_url_label"),field:"siteUrl",rules:[{required:!0}],children:e.jsx(G,{placeholder:o.t("feed_table.modal_edit_feed_site_url_placeholder")})}),e.jsx(P.Item,{label:o.t("feed_table.modal_edit_feed_feed_url_label"),field:"feedUrl",rules:[{required:!0}],children:e.jsx(G,{placeholder:o.t("feed_table.modal_edit_feed_feed_url_placeholder")})}),e.jsx(P.Item,{label:o.t("feed_table.modal_edit_feed_hidden_label"),field:"hidden",initialValue:b.hidden,triggerPropName:"checked",rules:[{type:"boolean"}],children:e.jsx(J,{})}),e.jsx(P.Item,{label:o.t("feed_table.modal_edit_feed_disabled_label"),field:"disabled",initialValue:b.disabled,triggerPropName:"checked",rules:[{type:"boolean"}],children:e.jsx(J,{})}),e.jsx(P.Item,{label:o.t("feed_table.modal_edit_feed_crawler_label"),field:"crawler",tooltip:e.jsx("div",{children:o.t("feed_table.modal_edit_feed_crawler_tooltip")}),triggerPropName:"checked",rules:[{type:"boolean"}],children:e.jsx(J,{})})]})})]})},Rn=[{label:"English",value:"en-US"},{label:"EspaÃ±ol",value:"es-ES"},{label:"ç®€ä½“ä¸­æ–‡",value:"zh-CN"}],Pn=()=>{const{homePage:t,language:s,markReadOnScroll:r,orderBy:n,pageSize:a,removeDuplicates:i,showUnreadFeedsOnly:o}=g(T),{polyglot:l}=g(O),u=[{label:l.t("settings.default_home_page_option_all"),value:"all"},{label:l.t("settings.default_home_page_option_today"),value:"today"},{label:l.t("settings.default_home_page_option_starred"),value:"starred"},{label:l.t("settings.default_home_page_option_history"),value:"history"}],d=[{label:l.t("settings.remove_duplicates_option_none"),value:"none"},{label:l.t("settings.remove_duplicates_option_hash"),value:"hash"},{label:l.t("settings.remove_duplicates_option_title"),value:"title"},{label:l.t("settings.remove_duplicates_option_url"),value:"url"}];return e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"setting-row",children:[e.jsxs("div",{children:[e.jsx(y.Title,{heading:6,style:{marginTop:0},children:l.t("appearance.language_label")}),e.jsx(y.Text,{type:"secondary",children:l.t("appearance.language_description")})]}),e.jsx("div",{children:e.jsx(R,{className:"input-select",onChange:c=>q({language:c}),value:s,children:Rn.map(({label:c,value:h})=>e.jsx(R.Option,{value:h,children:c},h))})})]}),e.jsx(W,{}),e.jsxs("div",{className:"setting-row",children:[e.jsxs("div",{children:[e.jsx(y.Title,{heading:6,style:{marginTop:0},children:l.t("settings.default_home_page_label")}),e.jsx(y.Text,{type:"secondary",children:l.t("settings.default_home_page_description")})]}),e.jsx("div",{children:e.jsx(R,{className:"input-select",onChange:c=>q({homePage:c}),value:t,children:u.map(({label:c,value:h})=>e.jsx(R.Option,{value:h,children:c},h))})})]}),e.jsx(W,{}),e.jsxs("div",{className:"setting-row",children:[e.jsxs("div",{children:[e.jsx(y.Title,{heading:6,style:{marginTop:0},children:l.t("settings.show_unread_feeds_only_label")}),e.jsx(y.Text,{type:"secondary",children:l.t("settings.show_unread_feeds_only_description")})]}),e.jsx("div",{children:e.jsx(J,{checked:o,onChange:c=>q({showUnreadFeedsOnly:c})})})]}),e.jsx(W,{}),e.jsxs("div",{className:"setting-row",children:[e.jsxs("div",{children:[e.jsx(y.Title,{heading:6,style:{marginTop:0},children:l.t("settings.entries_order_label")}),e.jsx(y.Text,{type:"secondary",children:l.t("settings.entries_order_description")})]}),e.jsx("div",{children:e.jsxs(R,{className:"input-select",onChange:c=>q({orderBy:c}),value:n,children:[e.jsx(R.Option,{value:"published_at",children:l.t("settings.entries_order_option_published_at")}),e.jsx(R.Option,{value:"created_at",children:l.t("settings.entries_order_option_created_at")})]})})]}),e.jsx(W,{}),e.jsxs("div",{className:"setting-row",children:[e.jsxs("div",{children:[e.jsx(y.Title,{heading:6,style:{marginTop:0},children:l.t("settings.entries_per_page_label")}),e.jsx(y.Text,{type:"secondary",children:l.t("settings.entries_per_page_description")})]}),e.jsx("div",{children:e.jsx(Vs,{className:"input-select",defaultValue:a,min:1,mode:"button",onChange:c=>q({pageSize:c}),size:"small"})})]}),e.jsx(W,{}),e.jsxs("div",{className:"setting-row",children:[e.jsxs("div",{children:[e.jsx(y.Title,{heading:6,style:{marginTop:0},children:l.t("settings.remove_duplicates_label")}),e.jsx(y.Text,{type:"secondary",children:l.t("settings.remove_duplicates_description")})]}),e.jsx("div",{children:e.jsx(R,{className:"input-select",onChange:c=>q({removeDuplicates:c}),value:i,children:d.map(({label:c,value:h})=>e.jsx(R.Option,{value:h,children:c},h))})})]}),e.jsx(W,{}),e.jsxs("div",{className:"setting-row",children:[e.jsxs("div",{children:[e.jsx(y.Title,{heading:6,style:{marginTop:0},children:l.t("settings.mark_read_on_scroll_label")}),e.jsx(y.Text,{type:"secondary",children:l.t("settings.mark_read_on_scroll_description")})]}),e.jsx("div",{children:e.jsx(J,{checked:r,onChange:c=>q({markReadOnScroll:c})})})]})]})},Dn=()=>{const{polyglot:t}=g(O),s=[{title:t.t("hotkeys.key"),dataIndex:"keyName",render:n=>e.jsx(ge,{children:n})},{title:t.t("hotkeys.function"),dataIndex:"description"}],r=[{key:"1",keyName:"Esc",description:t.t("hotkeys.esc")},{key:"2",keyName:"â†",description:t.t("hotkeys.left")},{key:"3",keyName:"Ctrl + â†",description:t.t("hotkeys.ctrl_left")},{key:"4",keyName:"â†’",description:t.t("hotkeys.right")},{key:"5",keyName:"Ctrl + â†’",description:t.t("hotkeys.ctrl_right")},{key:"6",keyName:"A",description:t.t("hotkeys.a")},{key:"7",keyName:"B",description:t.t("hotkeys.b")},{key:"8",keyName:"D",description:t.t("hotkeys.d")},{key:"9",keyName:"M",description:t.t("hotkeys.m")},{key:"10",keyName:"S",description:t.t("hotkeys.s")},{key:"11",keyName:"V",description:t.t("hotkeys.v")}];return e.jsx(Lt,{borderCell:!0,columns:s,data:r,pagination:!1,size:"small",style:{margin:"0 auto",width:"90%"}})},Mn=()=>{const{polyglot:t}=g(O),s=(r,n)=>e.jsxs("div",{style:{display:"flex",flexDirection:"column",alignItems:"center"},children:[r,e.jsx("div",{style:{fontSize:"12px"},children:n})]});return e.jsxs(ie,{className:"custom-tabs",defaultActiveTab:"1",tabPosition:"top",animation:!0,children:[e.jsx(ie.TabPane,{title:s(e.jsx(zs,{style:{fontSize:"20px"}}),t.t("settings.feeds")),children:e.jsx(Ln,{})},"1"),e.jsx(ie.TabPane,{title:s(e.jsx(Us,{style:{fontSize:"20px"}}),t.t("settings.categories")),children:e.jsx(In,{})},"2"),e.jsx(ie.TabPane,{title:s(e.jsx($s,{style:{fontSize:"20px"}}),t.t("settings.general")),children:e.jsx(Pn,{})},"3"),e.jsx(ie.TabPane,{title:s(e.jsx(Bs,{style:{fontSize:"20px"}}),t.t("settings.appearance")),children:e.jsx(Tn,{})},"4"),e.jsx(ie.TabPane,{title:s(e.jsx(Hs,{style:{fontSize:"20px"}}),t.t("settings.hotkeys")),children:e.jsx(Dn,{})},"5")]})},On=[{required:!0}],Vn=[{required:!0}],zn=[{type:"boolean"}],Un=()=>{const{setSettingsModalVisible:t,settingsModalVisible:s}=tt();return e.jsx(te,{alignCenter:!1,autoFocus:!1,className:"settings-modal",focusLock:!0,footer:null,onCancel:()=>t(!1),title:null,unmountOnExit:!0,visible:s,children:e.jsx(Mn,{})})},$n=()=>{const t=g(ye),{polyglot:s}=g(O),{addFeedModalVisible:r,setAddFeedModalVisible:n}=tt(),[a,i]=p.useState(!1),[o]=P.useForm(),{fetchAppData:l}=at(),u=async(d,c,h)=>{i(!0);try{await Zr(d,c,h),await l(),v.success(s.t("main.add_feed_success")),n(!1),o.resetFields()}catch{v.error(s.t("main.add_feed_error"))}finally{i(!1)}};return e.jsx(te,{title:s.t("main.add_feed_modal_title"),visible:r,unmountOnExit:!0,style:{width:"400px"},onOk:o.submit,confirmLoading:a,onCancel:()=>{n(!1),o.resetFields()},children:e.jsxs(P,{form:o,labelCol:{span:7},layout:"vertical",wrapperCol:{span:17},onSubmit:async d=>{const c=d.url.trim();c?await u(c,d.category,d.crawler):v.error(s.t("main.add_feed_url_empty"))},children:[e.jsx(P.Item,{label:s.t("main.add_feed_modal_feed_url_label"),field:"url",rules:On,children:e.jsx(G,{placeholder:s.t("main.add_feed_modal_feed_url_placeholder")})}),e.jsx(P.Item,{field:"category",label:s.t("main.add_feed_modal_category_label"),required:!0,rules:Vn,children:e.jsx(R,{placeholder:s.t("main.add_feed_modal_category_placeholder"),showSearch:!0,filterOption:(d,c)=>pn(c.props.children,d),children:t.map(d=>e.jsx(R.Option,{value:d.id,children:d.title},d.id))})}),e.jsx(P.Item,{field:"crawler",initialValue:!1,label:s.t("main.add_feed_modal_crawler_label"),rules:zn,style:{marginBottom:0},triggerPropName:"checked",children:e.jsx(J,{})})]})})},Bn=()=>e.jsxs("div",{className:"main",children:[e.jsx(qs,{}),e.jsx(Un,{}),e.jsx($n,{})]}),os=()=>{const{theme:t,themeColor:s}=g(T),[r,n]=p.useState(window.matchMedia("(prefers-color-scheme: dark)").matches);p.useEffect(()=>{const a=window.matchMedia("(prefers-color-scheme: dark)"),i=o=>n(o.matches);return a.addEventListener("change",i),()=>a.removeEventListener("change",i)},[]),p.useEffect(()=>{const a=i=>{const o=i?"dark":"light";document.body.setAttribute("arco-theme",o),document.body.style.colorScheme=o};rs(s),a(t==="system"?r:t==="dark")},[r,t,s])},is=()=>{const t=document.querySelector(".spinner");t&&(t.style.display="none")},Hn=()=>{Ot(),os();const{isBelowLarge:t}=xe(),{polyglot:s}=g(O);return p.useEffect(()=>{is()},[]),s&&e.jsxs("div",{className:"app",children:[t?null:e.jsx(Ws.Sider,{breakpoint:"lg",className:"sidebar",collapsible:!1,trigger:null,width:240,children:e.jsx(ss,{})}),e.jsx(Cn,{}),e.jsx(Bn,{})]})},ls=t=>{const r=new DOMParser().parseFromString(t,"text/html").querySelectorAll("img");return Array.from(r).map(n=>n.getAttribute("src"))},cs=t=>{var a;const n=(a=new DOMParser().parseFromString(t.content,"text/html").querySelector("img"))==null?void 0:a.getAttribute("src");return{...t,imgSrc:n}},qn=t=>{if((t==null?void 0:t.total)>=0){const s=t.entries.map(cs);_e(s),yn(t.total),Zt(s.length<t.total)}},Wn=t=>{const{isAppDataReady:s}=g(z),{showStatus:r}=g(T),n=p.useRef(!1),a=async i=>{if(!n.current){n.current=!0,_t(!1);try{const o=r==="unread"?await i(0,"unread"):await i();_t(!0),ne(!0),qn(o)}catch(o){console.error("Error fetching articles: ",o),ne(!1)}finally{n.current=!1}}};return p.useEffect(()=>{s&&a(t)},[s]),{fetchArticleList:a}},ds=Xe(!1),St=E(ds),it=()=>{const{offset:t}=g(N),{pageSize:s,showStatus:r}=g(T),n=g(ds),a=o=>{const l=(u,d)=>d.filter(c=>!u.some(h=>h.id===c.id));_e(u=>[...u,...l(u,o)]),Pe(u=>u+s)};return{handleLoadMore:async o=>{var l;St(!0);try{const u=r==="unread"?await o(t+s,"unread"):await o(t+s);if(((l=u==null?void 0:u.entries)==null?void 0:l.length)>0){const d=u.entries.map(cs);a(d)}else Zt(!1)}catch(u){console.error("Error fetching more articles: ",u)}finally{St(!1)}},loadingMore:n}},lt=ce({isPhotoSliderVisible:!1,selectedIndex:0}),Kn=E(lt,"isPhotoSliderVisible"),Gn=E(lt,"selectedIndex"),us=()=>{const{isPhotoSliderVisible:t,selectedIndex:s}=g(lt);return{isPhotoSliderVisible:t,setIsPhotoSliderVisible:Kn,selectedIndex:s,setSelectedIndex:Gn}},hs=(t,s)=>{const{activeContent:r,loadMoreVisible:n}=g(N),a=g(ze),{isPhotoSliderVisible:i,setIsPhotoSliderVisible:o,setSelectedIndex:l}=us(),{loadingMore:u}=it(),[d,c]=p.useState(!1),[h,x]=p.useState(!1);p.useEffect(()=>{h&&!u&&(c(!1),x(!1),k())},[u,h]),p.useEffect(()=>{var A;r&&((A=document.querySelector(".card-custom-selected-style"))==null||A.scrollIntoView({behavior:"smooth",block:"nearest"}))},[r]);const j=A=>(...U)=>{if(r)return A(...U)},f=j(()=>{Z(null),s.current&&s.current.contentWrapperEl.focus()}),b=(A=!1)=>{const U=a.findIndex(K=>K.id===(r==null?void 0:r.id));if(U>0){const K=A?a.slice(0,U).toReversed().find(m=>m.status==="unread"):a[U-1];K&&t(K)}},k=(A=!1)=>{if(d)return;const U=a.findIndex(_=>_.id===(r==null?void 0:r.id));if(U===a.length-1&&n){c(!0),x(!0);return}if(U===-1){s.current.contentWrapperEl.scrollTo({top:0,left:0,behavior:"smooth"});return}const m=A?a.slice(U+1).find(_=>_.status==="unread"):a[U+1];m&&(t(m),x(!1))},w=j(()=>{window.open(r.url,"_blank")}),L=j(A=>{A()}),C=j(A=>{A()}),H=j(A=>{A()}),D=j(A=>{A()}),X=j(()=>{!ls(r.content).length||i||(l(0),o(!0),ne(!1))});return{exitDetailView:f,fetchOriginalArticle:L,navigateToNextArticle:k,navigateToPreviousArticle:b,openLinkExternally:w,openPhotoSlider:X,saveToThirdPartyServices:C,toggleReadStatus:H,toggleStarStatus:D}},Yn=({handleEntryClick:t,entryListRef:s})=>{const{activeContent:r}=g(N),n=g(ze),[a,i]=p.useState(!1),{handleFetchContent:o,handleSaveToThirdPartyServices:l,handleToggleStarred:u,handleToggleStatus:d}=nt(),{exitDetailView:c,navigateToNextArticle:h,navigateToPreviousArticle:x}=hs(t,s),j=r.status==="unread",f=r.starred,b=n.findIndex(L=>L.id===(r==null?void 0:r.id)),k=b===0,w=b===n.length-1;return e.jsxs("div",{className:"action-buttons",children:[e.jsxs("div",{className:"left-side",children:[e.jsx(I,{icon:e.jsx(Ks,{}),onClick:()=>c(),shape:"circle"}),e.jsx(I,{icon:e.jsx(Gs,{}),onClick:()=>x(),shape:"circle",disabled:k}),e.jsx(I,{icon:e.jsx(Ys,{}),onClick:()=>h(),shape:"circle",disabled:w})]}),e.jsxs("div",{className:"right-side",children:[e.jsx(I,{icon:j?e.jsx(Rt,{}):e.jsx(Pt,{}),onClick:()=>d(r),shape:"circle"}),e.jsx(I,{icon:f?e.jsx(Qe,{style:{color:"#ffcd00"}}):e.jsx(Ye,{}),onClick:()=>u(r),shape:"circle"}),e.jsx(I,{icon:e.jsx(Xs,{}),onClick:async()=>{await o(),i(!0)},shape:"circle",disabled:a}),e.jsx(I,{icon:e.jsx(Qs,{}),onClick:l,shape:"circle"})]})]})},Xn=({url:t,text:s})=>{const[r,n]=p.useState(!1),a=()=>n(!r);return e.jsx(er,{to:t,style:{color:"inherit",textDecoration:r?"underline":"none"},onMouseEnter:a,onMouseLeave:a,children:s})},Ct=({node:t,index:s,togglePhotoSlider:r,isLinkWrapper:n=!1})=>{var f;const{fontSize:a}=g(T),[i,o]=p.useState(!1),[l,u]=p.useState(!1),{isBelowMedium:d}=xe();p.useEffect(()=>{const k=(n?t.children[0]:t).attribs.src,w=new Image;w.src=k,w.onload=()=>u(w.width<=100&&w.height<=100)},[t,n]);const c=n?t.children[0]:t,h=()=>e.jsx("img",{...c.attribs,alt:c.attribs.alt??"image",style:l?{display:"inline-block",width:"auto",height:`${a}rem`,margin:0}:{}});if(l)return n?e.jsxs("a",{...t.attribs,children:[h(),(f=t.children[1])==null?void 0:f.data]}):h();const x=()=>o(!0),j=()=>o(!1);return e.jsx("div",{style:{textAlign:"center",position:"relative"},children:e.jsxs("div",{style:{display:"inline-block",position:"relative"},onMouseEnter:x,onMouseLeave:j,children:[n?e.jsx("a",{...t.attribs,children:h()}):h(),e.jsx(I,{icon:e.jsx(tr,{}),shape:"circle",style:{position:"absolute",top:30,right:10,color:"white",backgroundColor:"rgba(0, 0, 0, 0.5)",opacity:d||i?1:0,transition:"opacity 0.3s"},onClick:b=>{b.preventDefault(),r(s)}})]})})},Qn=(t,s)=>({replace:r=>{if(r.type==="tag"&&r.name==="a"&&r.children.length>0){const n=r.children[0];if(n.type==="tag"&&n.name==="img"){const a=t.findIndex(i=>i===n.attribs.src);return e.jsx(Ct,{node:r,index:a,togglePhotoSlider:s,isLinkWrapper:!0})}}else if(r.type==="tag"&&r.name==="img"){const n=t.findIndex(a=>a===r.attribs.src);return e.jsx(Ct,{node:r,index:n,togglePhotoSlider:s})}return r}}),Jn=p.forwardRef((t,s)=>{const r=ae(),{activeContent:n}=g(N),{articleWidth:a,fontFamily:i,fontSize:o}=g(T),{isPhotoSliderVisible:l,setIsPhotoSliderVisible:u,selectedIndex:d,setSelectedIndex:c}=us(),h=()=>{Re("author"),Le(n.author)},x=L=>{c(L),u(C=>!C),ne(C=>!C)},j=ls(n.content),f=Qn(j,x),b=Js(n.content,f),{id:k,title:w}=n.feed.category;return e.jsx("article",{className:"article-content",onBlur:()=>ne(!1),onFocus:()=>ne(!0),ref:s,tabIndex:-1,children:e.jsxs(Ge,{className:"scroll-container",children:[e.jsxs("div",{className:"article-header",style:{width:`${a}%`},children:[e.jsx(y.Title,{className:"article-title",heading:3,children:e.jsx("a",{href:n.url,target:"_blank",rel:"noopener noreferrer",children:n.title})}),e.jsxs("div",{className:"article-meta",children:[e.jsx(y.Text,{children:e.jsx(Xn,{url:`/feed/${n.feed.id}`,text:n.feed.title})}),e.jsx(y.Text,{onClick:h,style:{cursor:"pointer"},children:` - ${n.author}`}),e.jsx(y.Text,{children:e.jsx(ge,{size:"small",style:{marginLeft:"10px",cursor:"pointer"},onClick:()=>r(`/category/${k}`),children:w})})]}),e.jsx(y.Text,{className:"article-date",children:Br(n.published_at)}),e.jsx("br",{}),e.jsx(y.Text,{className:"article-date",children:$t(n.reading_time)}),e.jsx(W,{})]}),e.jsxs("div",{className:"article-body",style:{fontSize:`${o}rem`,width:`${a}%`,fontFamily:i},children:[b,e.jsx(Zs,{images:j.map(L=>({src:L,key:L})),loop:!1,visible:l,onClose:()=>{u(!1),ne(!0)},index:d,onIndexChange:c})]},n.id)]})})}),Zn=({alt:t,borderRadius:s,height:r,src:n,status:a,width:i})=>{const[o,l]=p.useState(!1),{ref:u}=Me({triggerOnce:!0,onChange:(d,c)=>{if(d&&!o){const h=new Image;h.onload=()=>l(!0),h.onerror=()=>{c.target.style.display="none"},h.src=n}}});return e.jsx("div",{className:"image-container",ref:u,children:e.jsx("div",{className:"img-placeholder",style:{width:"100%",height:"100%",backgroundColor:"var(--color-fill-2)",position:"absolute",left:0,top:0},children:o?e.jsx("img",{className:a==="unread"?"":"read",src:n,alt:t,style:{width:i,height:r,objectFit:"cover",borderRadius:s}}):e.jsx("div",{className:"skeleton-container",children:e.jsx(Ie,{text:{rows:0},image:{style:{width:i,height:r,margin:"0",borderRadius:s}},animation:!0})})})})},ea=({entry:t,isThumbnail:s})=>{if(!t.imgSrc)return null;const r=s?{width:"80px",height:"80px"}:{width:"100%",height:"160px"};return e.jsx("div",{className:s?"thumbnail":"cover-image",children:e.jsx(Zn,{alt:t.id,borderRadius:s?"2px":void 0,src:t.imgSrc,status:t.status,width:r.width,height:r.height})})},ta=({entry:t,showFeedIcon:s,mini:r,children:n})=>{const{showDetailedRelativeTime:a}=g(T),i=De({"article-card-mini-content":r,"article-card-mini-content-padding":r&&s});return e.jsxs("div",{className:i,style:{width:"100%",boxSizing:"border-box",opacity:t.status==="unread"?1:.5},children:[e.jsx("div",{style:{padding:t.imgSrc?r?"0 10px 0 0":"0 0 10px 0":"0"},children:e.jsx(ea,{entry:t,isThumbnail:r})}),e.jsxs("div",{className:r?"article-card-mini-content-text":"",children:[e.jsx(y.Text,{className:"article-card-title",children:t.title}),e.jsxs(y.Text,{className:"article-card-info",children:[e.jsx("br",{}),s&&e.jsx(es,{feed:t.feed,className:r?"feed-icon-mini":"feed-icon"}),t.feed.title,e.jsx("br",{}),Ut(t.published_at,a),e.jsx("br",{}),$t(t.reading_time)]}),t.starred&&e.jsx(Qe,{className:"icon-starred"})]}),e.jsx("div",{children:n})]})},sa=({entry:t,handleEntryClick:s,mini:r,children:n})=>{const{markReadOnScroll:a,showFeedIcon:i}=g(T),{activeContent:o}=g(N),{polyglot:l}=g(O),u=o&&t.id===o.id,{handleToggleStarred:d,handleToggleStatus:c}=nt(),[h,x]=p.useState(0),j=60,f=.5,b=t.starred,k=t.status==="unread",w=sr({preventScrollOnSwipe:!0,delta:j/2,onSwiping:m=>{const _=Math.min(Math.abs(m.deltaX*f),j)*Math.sign(m.deltaX);x(_)},onSwiped:async m=>{try{m.deltaX>j?(await d(t),v.success(b?l.t("article_card.unmarked_as_starred"):l.t("article_card.marked_as_starred"))):m.deltaX<-j&&(await c(t),v.success(k?l.t("article_card.marked_as_read"):l.t("article_card.marked_as_unread")))}catch{v.error(l.t("article_card.update_failed"))}x(0)}}),[L,C]=p.useState(!1),[H,D]=p.useState(!1),X=()=>c(t),A=20,{ref:U}=Me({skip:H,onChange:async(m,_)=>{if(!(!a||!k)){if(m)C(!0);else if(L){const{top:F}=_.boundingClientRect;F<A&&(await X(),D(!0))}}}}),K=rr({x:h});return p.createElement("div",{...w,className:"article-card",key:t.id},e.jsxs("div",{ref:U,children:[e.jsx(nr.div,{className:"swipe-card",style:K,children:e.jsx(Ae,{className:De("swipe-content","card-custom-style","card-custom-hover-style",{"card-custom-selected-style":u}),"data-entry-id":t.id,hoverable:!0,onClick:()=>s(t),bordered:!1,children:e.jsx(Ae.Meta,{description:e.jsx(ta,{entry:t,showFeedIcon:i,mini:r,children:n})})})}),e.jsxs("div",{className:"swipe-actions",children:[e.jsx("div",{className:"swipe-action left",children:b?e.jsx(Qe,{style:{color:"#ffcd00",fontSize:"24px"}}):e.jsx(Ye,{style:{color:"#ffffff",fontSize:"24px"}})}),e.jsx("div",{className:"swipe-action right",children:k?e.jsx(Rt,{style:{color:"#ffffff",fontSize:"24px"}}):e.jsx(Pt,{style:{color:"#ffffff",fontSize:"24px"}})})]})]}))},ra=()=>{const{layout:t}=g(T),{isArticleListReady:s}=g(N),r=t==="large"?2:4,n=a=>e.jsx(Ae,{className:"card-style",cover:t==="large"?e.jsx("div",{className:"card-cover-style"}):null,children:e.jsx(Ae.Meta,{description:e.jsx(Ie,{loading:!s,animation:!0,text:{rows:3,width:150}})})},a);return!s&&Array.from({length:r},(a,i)=>n(i))},na=()=>{const{orderDirection:t}=g(T),{filterType:s}=g(N),{polyglot:r}=g(O),n=r.t("search.tooltip").split(`
`),[a,i]=p.useState(""),o=p.useCallback(En(d=>Le(d),500),[]),{isBelowMedium:l}=xe(),u=()=>{q({orderDirection:t==="desc"?"asc":"desc"})};return p.useEffect(()=>{Re("title")},[]),p.useEffect(()=>{a===""?Le(a):o(a)},[a,o]),e.jsxs("div",{className:"search-and-sort-bar",children:[e.jsx(G.Search,{allowClear:!0,onChange:i,placeholder:r.t("search.placeholder"),style:{width:l?"100%":272,marginLeft:8},addBefore:e.jsxs(R,{onChange:Re,style:{width:100},value:s,children:[e.jsx(R.Option,{value:"title",children:r.t("search.type_title")}),e.jsx(R.Option,{value:"content",children:r.t("search.type_content")}),e.jsx(R.Option,{value:"author",children:r.t("search.type_author")})]})}),e.jsxs("div",{className:"button-group",children:[e.jsx(le,{mini:!0,content:e.jsx("div",{children:n.map((d,c)=>e.jsxs(p.Fragment,{children:[d,c<n.length-1&&e.jsx("br",{})]},`line-${c}-${d.length}`))}),children:e.jsx(I,{shape:"circle",size:"small",icon:e.jsx(Nt,{})})}),e.jsx(le,{mini:!0,content:t==="desc"?r.t("article_list.sort_direction_desc"):r.t("article_list.sort_direction_asc"),children:e.jsx(I,{shape:"circle",size:"small",icon:t==="desc"?e.jsx(ar,{}):e.jsx(or,{}),onClick:u})})]})]})},aa=(...t)=>s=>{for(const r of t)typeof r=="function"?r(s):r&&typeof r=="object"&&(r.current=s)},oa=(t,s,r)=>{p.useLayoutEffect(()=>{let n=null;return t>0&&(clearTimeout(n),n=setTimeout(()=>{r(),clearTimeout(n)},s*4)),()=>clearTimeout(n)},[t,s,r])},ia=({duration:t,color:s})=>{const[r,n]=p.useState([]);oa(r.length,t,()=>{n([])});const a=i=>{const o=i.currentTarget.getBoundingClientRect(),l=o.width>o.height?o.width:o.height,u=i.pageX-o.x-l/2,d=i.pageY-o.y-l/2,c={x:u,y:d,size:l,id:`${new Date().getTime()}-${u}-${d}`};n([...r,c])};return e.jsx("div",{className:"ripple-container",onMouseDown:a,children:r.length>0&&r.map(i=>e.jsx("span",{className:"ripple-span",style:{top:i.y,left:i.x,width:i.size,height:i.size,backgroundColor:s,animationDuration:`${t}ms`}},i.id))})},la=({getEntries:t})=>{const{isArticleListReady:s,loadMoreVisible:r}=g(N),{loadingMore:n,handleLoadMore:a}=it(),{ref:i,inView:o}=Me(),l=p.useCallback(async()=>{r&&o&&s&&!n&&await a(t)},[r,o,s,n,a,t]);return p.useEffect(()=>{const u=setInterval(l,500);return()=>clearInterval(u)},[l]),s&&r&&e.jsxs("div",{className:"load-more-container",ref:i,children:[e.jsx(lr,{loading:n,style:{paddingRight:"10px"}}),"Loading more ..."]})},ca=p.forwardRef(({getEntries:t,handleEntryClick:s,cardsRef:r},n)=>{const{layout:a,pageSize:i}=g(T),o=a==="small",{isArticleListReady:l,loadMoreVisible:u}=g(N),d=g(ze),c=d.length-Math.ceil(i*.2)-1,{loadingMore:h,handleLoadMore:x}=it(),{ref:j}=Me({skip:!u,onChange:async w=>{!w||!l||h||await x(t)}}),f=ir({count:d.length,getScrollElement:()=>r.current,estimateSize:p.useCallback(()=>o?120:280,[o]),overscan:5}),b=f.getVirtualItems(),k=p.useCallback(w=>w===c?aa(f.measureElement,j):f.measureElement,[c,f.measureElement,j]);return e.jsxs(e.Fragment,{children:[e.jsx(na,{}),e.jsxs(Ge,{className:"entry-list",ref:n,children:[e.jsx(ra,{}),l&&e.jsx("div",{ref:r,children:e.jsx("div",{style:{height:f.getTotalSize(),width:"100%",position:"relative"},children:b.map(w=>e.jsx("div",{"data-index":w.index,ref:k(w.index),style:{position:"absolute",top:0,left:0,width:"100%",transform:`translateY(${w.start}px)`},children:e.jsx(sa,{entry:d[w.index],handleEntryClick:s,mini:o,children:e.jsx(ia,{color:"var(--color-text-4)",duration:1e3})})},w.key))})}),e.jsx(la,{getEntries:t})]})]})}),da=()=>{_e(t=>t.map(s=>({...s,status:"read"})))},ua=({info:t,refreshArticleList:s,markAllAsRead:r})=>{const{isArticleListReady:n}=g(N),{showStatus:a}=g(T),{polyglot:i}=g(O),{fetchAppData:o}=at(),l=async()=>{try{await r(),da(),await o(),v.success(i.t("article_list.mark_all_as_read_success"))}catch{v.error(i.t("article_list.mark_all_as_read_error"))}},u=d=>{q({showStatus:d})};return p.useEffect(()=>{Re("title"),Le("")},[a]),e.jsxs("div",{className:"entry-panel",children:[e.jsx(At,{focusLock:!0,onOk:l,title:i.t("article_list.mark_all_as_read_confirm"),children:e.jsx(I,{icon:e.jsx(Ft,{}),shape:"circle",style:{visibility:["starred","history"].includes(t.from)?"hidden":"visible"}})}),e.jsx(cr.Group,{onChange:u,options:[{label:i.t("article_list.filter_status_all"),value:"all"},{label:i.t("article_list.filter_status_unread"),value:"unread"}],style:{visibility:t.from==="history"?"hidden":"visible"},type:"button",value:a}),e.jsx(I,{icon:e.jsx(Ee,{}),loading:!n,shape:"circle",onClick:s})]})},ue=({info:t,getEntries:s,markAllAsRead:r})=>{const{activeContent:n,isArticleFocused:a,isArticleListReady:i}=g(N),{isAppDataReady:o}=g(z),{orderBy:l,orderDirection:u,showAllFeeds:d,showStatus:c}=g(T),h=g(ze),x=g(rt),{polyglot:j}=g(O),{handleFetchContent:f,handleSaveToThirdPartyServices:b,handleToggleStarred:k,handleToggleStatus:w,handleEntryStatusUpdate:L}=nt(),{fetchAppData:C}=at(),{fetchArticleList:H}=Wn(s),[D,X]=p.useState(!1),A=p.useRef(null),U=p.useRef(null),K=p.useRef(null);p.useEffect(()=>{xn(t.from),n&&Z(null),me(s)},[t]),p.useEffect(()=>{["starred","history"].includes(t.from)||me(s)},[l]),p.useEffect(()=>{x.length===0||["starred","history"].includes(t.from)||me(s)},[d]),p.useEffect(()=>{me(s)},[u,c]);const m=async Q=>{X(!0),Z({...Q,status:"read"}),setTimeout(()=>{var fe;(fe=K.current)==null||fe.focus(),X(!1),Q.status==="unread"&&(L(Q,"read"),Ve([Q.id],"read").catch(()=>{v.error(j.t("content.mark_as_read_error")),Z({...Q,status:"unread"}),L(Q,"unread")}))},200)},{exitDetailView:_,fetchOriginalArticle:F,navigateToNextArticle:V,navigateToPreviousArticle:M,openLinkExternally:se,openPhotoSlider:oe,saveToThirdPartyServices:je,toggleReadStatus:he,toggleStarStatus:ct}=hs(m,A);p.useEffect(()=>{const Q={ArrowLeft:()=>M(),ArrowRight:()=>V(),Escape:()=>_(),a:()=>je(b),b:se,d:()=>F(f),m:()=>he(()=>w(n)),s:()=>ct(()=>k(n)),v:oe},fe=pe=>{const dt=Q[pe.key];dt&&(pe.key==="ArrowLeft"?M(pe.ctrlKey):pe.key==="ArrowRight"?V(pe.ctrlKey):dt())};if(a)return document.addEventListener("keydown",fe),()=>{document.removeEventListener("keydown",fe)}},[n,h,a]);const me=async Q=>{Pe(0),o?await H(Q):await C()};return e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"entry-col",children:[e.jsx(Ue,{in:i,timeout:200,nodeRef:U,classNames:"fade",children:e.jsx(ca,{cardsRef:U,getEntries:s,handleEntryClick:m,ref:A})}),e.jsx(ua,{info:t,refreshArticleList:()=>me(s),markAllAsRead:r})]}),n?e.jsxs("div",{className:"article-container",children:[e.jsx(Ue,{in:!D,timeout:200,nodeRef:K,classNames:"fade",unmountOnExit:!0,children:e.jsx(Jn,{ref:K})}),e.jsx(Ue,{in:!D,timeout:200,unmountOnExit:!0,children:e.jsx(Yn,{handleEntryClick:m,entryListRef:A})})]}):e.jsxs("div",{className:"content-empty",children:[e.jsx(dr,{style:{fontSize:"64px"}}),e.jsx(y.Title,{heading:6,style:{color:"var(--color-text-3)",marginTop:"10px"},children:"ReactFlux"})]})]})},ha=()=>e.jsx(ue,{info:{from:"all",id:""},getEntries:Kr,markAllAsRead:an}),ma=()=>{const{id:t}=Dt(),s=B("orderBy"),r=B("pageSize"),n=B("showAllFeeds"),a=async(i=0,o=null)=>{const l={baseUrl:`/v1/categories/${t}/entries`,orderField:s,offset:i,limit:r,status:o},u={globally_visible:!n};return S.get(de(l,u))};return e.jsx(ue,{info:{from:"category",id:t},getEntries:a,markAllAsRead:()=>Vr(t)})},fa=()=>{const t=ae(),s=ur();return console.error(s),e.jsx("div",{id:"error-page",style:{top:"30%",position:"relative"},children:e.jsx(hr,{status:"404",subTitle:s.statusText||s.message,extra:[e.jsx(I,{type:"primary",onClick:()=>t("/"),children:"Back to Home"},"back")]})})},pa=()=>{const{id:t}=Dt(),s=B("orderBy"),r=B("pageSize"),n=async(a=0,i=null)=>{const o={baseUrl:`/v1/feeds/${t}/entries`,orderField:s,offset:a,limit:r,status:i};return S.get(de(o))};return e.jsx(ue,{info:{from:"feed",id:t},getEntries:n,markAllAsRead:()=>tn(t)})},ga=()=>e.jsx(ue,{info:{from:"history",id:""},getEntries:Gr}),xa=t=>{const s=t.getFieldsValue();let r=!0;for(const[n,a]of Object.entries(s))if(n!=="password"){const i=a==null?void 0:a.trim();t.setFieldValue(n,i),i||(r=!1)}else a||(r=!1);return r},Ce=(t,s)=>{t.key==="Enter"&&s.submit()},ya=()=>{Ot(),os();const t=g(Oe),{homePage:s}=g(T),{polyglot:r}=g(O),[n]=mr(),[a,i]=p.useState(!1),[o,l]=p.useState("token"),u=ae(),d=async()=>{i(!0);const{server:h,token:x,username:j,password:f}=n.getFieldsValue();try{(await Tt.raw("v1/me",{baseURL:h,headers:x?{"X-Auth-Token":x}:{Authorization:`Basic ${btoa(`${j}:${f}`)}`}})).status===200&&(v.success(r.t("login.success")),zt({server:h,token:x,username:j,password:f}),u("/"))}catch(b){console.error(b),v.error(b.message)}i(!1)},c=async()=>{const h=n.getFieldsValue();if(!Ne(h)){v.error(r.t("login.auth_error"));return}await d()};return p.useEffect(()=>{is()},[]),Ne(t)?e.jsx(Je,{to:`/${s}`}):r&&e.jsxs("div",{className:"page-layout",children:[e.jsx("div",{className:"form-panel",children:e.jsxs("div",{className:"login-form",children:[e.jsx(y.Title,{heading:3,children:r.t("login.login_to_your_server")}),e.jsxs(P,{autoComplete:"off",form:n,layout:"vertical",onSubmit:async()=>{xa(n)?await c():v.error(r.t("login.submit_error"))},children:[e.jsx(P.Item,{field:"server",label:r.t("login.server_label"),rules:[{required:!0}],onKeyDown:h=>{Ce(h,n)},children:e.jsx(G,{disabled:a,placeholder:r.t("login.server_placeholder"),prefix:e.jsx(fr,{})})}),o==="token"&&e.jsx(P.Item,{field:"token",label:r.t("login.token_label"),rules:[{required:!0}],onKeyDown:h=>{Ce(h,n)},children:e.jsx(G.Password,{disabled:a,placeholder:r.t("login.token_placeholder"),prefix:e.jsx(pt,{})})}),o==="user"&&e.jsxs(e.Fragment,{children:[e.jsx(P.Item,{field:"username",label:r.t("login.username_label"),rules:[{required:!0}],onKeyDown:h=>{Ce(h,n)},children:e.jsx(G,{disabled:a,placeholder:r.t("login.username_placeholder"),prefix:e.jsx(Et,{})})}),e.jsx(P.Item,{field:"password",label:r.t("login.password_label"),rules:[{required:!0}],onKeyDown:h=>{Ce(h,n)},children:e.jsx(G.Password,{disabled:a,placeholder:r.t("login.password_placeholder"),prefix:e.jsx(pt,{})})})]})]}),e.jsx(I,{loading:a,type:"primary",long:!0,onClick:()=>n.submit(),style:{marginTop:"20px"},children:r.t("login.login_button")}),e.jsx(W,{orientation:"center",children:r.t("login.another_login_method")}),e.jsx(I,{type:"secondary",long:!0,onClick:()=>l(o==="token"?"user":"token"),style:{marginTop:"20px"},children:o==="token"?r.t("login.another_login_button"):r.t("login.token_label")}),e.jsxs("div",{style:{display:"flex",marginTop:"40px"},children:[e.jsx(y.Text,{disabled:!0,children:r.t("login.need_help")}),e.jsx(pr,{href:"https://miniflux.app/docs/api.html#authentication",style:{fontWeight:"500"},children:r.t("login.miniflux_official_website")})]})]})}),e.jsx("div",{className:"background"})]})},_a=({children:t})=>{const s=g(Oe);return Ne(s)?e.jsx(e.Fragment,{children:t}):e.jsx(Je,{to:"/login"})},ja=()=>e.jsx(ue,{info:{from:"starred",id:""},getEntries:Bt}),ba=()=>{const t=async()=>{const s=await ke(0,"unread"),r=s.total;let n=s.entries;r>n.length&&(n=ke(0,"unread",r).then(i=>i.entries));const a=n.map(i=>i.id);return Ve(a,"read")};return e.jsx(ue,{info:{from:"today",id:""},getEntries:ke,markAllAsRead:t})},va=B("homePage"),wa=[{path:"/all",element:e.jsx(ha,{})},{path:"/today",element:e.jsx(ba,{})},{path:"/starred",element:e.jsx(ja,{})},{path:"/history",element:e.jsx(ga,{})},{path:"/category/:id",element:e.jsx(ma,{})},{path:"/feed/:id",element:e.jsx(pa,{})}],ms=gr([{path:"/",element:e.jsx(_a,{children:e.jsx(Hn,{})}),errorElement:e.jsx(fa,{}),children:[...wa,{index:!0,element:e.jsx(Je,{to:`/${va}`,replace:!0})}]},{path:"/login",element:e.jsx(ya,{})}]),Sa={"zh-CN":br,"es-ES":vr},Ca=()=>Sa[kr()]||jr;xr.createRoot(document.getElementById("root")).render(e.jsx(yr,{locale:Ca(),children:e.jsx(_r,{router:ms})}));
