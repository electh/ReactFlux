import{m as Te,u as g,r as p,p as ut,i as Jt,o as ht,d as B,a as Qt,b as Zt,c as es,e as K,M as b,C as ts,j as e,f as J,g as _e,h as ee,A as mt,I as ss,T as y,S as we,k as Qe,l as rs,n as ns,q as Ue,s as as,t as is,v as Ie,B as M,w as os,D as ls,x as ve,y as le,z as ft,E as cs,F as ds,G as us,H as Ze,J as pt,K as hs,L as Se,N as ms,O as gt,P as Q,Q as fs,R as ps,U as gs,V as xs,W as ys,X as H,Y,Z as et,_ as P,$ as ce,a0 as O,a1 as xt,a2 as tt,a3 as yt,a4 as $,a5 as jt,a6 as js,a7 as bs,a8 as se,a9 as ws,aa as vs,ab as Ss,ac as Cs,ad as ks,ae as Fs,af as Ts,ag as Is,ah as bt,ai as wt,aj as $e,ak as As,al as Es,am as Ns,an as Rs,ao as Ms,ap as Ls,aq as Ps,ar as Ds,as as Ae,at as _s,au as Us,av as $s,aw as Ce,ax as Vs,ay as zs,az as Os,aA as Bs,aB as Hs,aC as st,aD as vt,aE as qs,aF as Ws,aG as Ks,aH as Gs,aI as rt,aJ as Ys,aK as St,aL as Xs,aM as Js,aN as Qs,aO as Zs,aP as er}from"./vendor-Bj8ABivq.js";(function(){const s=document.createElement("link").relList;if(s&&s.supports&&s.supports("modulepreload"))return;for(const a of document.querySelectorAll('link[rel="modulepreload"]'))n(a);new MutationObserver(a=>{for(const i of a)if(i.type==="childList")for(const o of i.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&n(o)}).observe(document,{childList:!0,subtree:!0});function r(a){const i={};return a.integrity&&(i.integrity=a.integrity),a.referrerPolicy&&(i.referrerPolicy=a.referrerPolicy),a.crossOrigin==="use-credentials"?i.credentials="include":a.crossOrigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function n(a){if(a.ep)return;a.ep=!0;const i=r(a);fetch(a.href,i)}})();const D=(t,s=null)=>r=>{const n=t.get();if(typeof n=="object"&&n!==null){if(s===null)return;typeof r=="function"?t.set({...n,[s]:r(n[s])}):t.set({...n,[s]:r})}else typeof r=="function"?t.set(r(n)):t.set(r)},Ve=Te({addFeedModalVisible:!1,settingsModalVisible:!1}),tr=D(Ve,"addFeedModalVisible"),sr=D(Ve,"settingsModalVisible"),ze=()=>{const{addFeedModalVisible:t,settingsModalVisible:s}=g(Ve);return{addFeedModalVisible:t,setAddFeedModalVisible:tr,settingsModalVisible:s,setSettingsModalVisible:sr}},de=()=>{const[t,s]=p.useState(window.innerWidth),r=t<=768,n=t<=992;return p.useEffect(()=>{const a=()=>s(window.innerWidth);return window.addEventListener("resize",a),()=>window.removeEventListener("resize",a)},[]),{width:t,isBelowMedium:r,isBelowLarge:n}},Ct={server:"",token:"",username:"",password:""},Oe=ut("auth",Ct,{encode:JSON.stringify,decode:JSON.parse}),kt=t=>Oe.set(t),rr=()=>kt(Ct),nr=t=>{try{const s=new URL(t),{hostname:r,port:n}=s;return!!r&&!!n}catch{return!1}},Be=t=>{const{server:s,token:r,username:n,password:a}=t;return!s||!Jt(s,{require_protocol:!0})&&!nr(s)?!1:r||n&&a},ar=()=>ht.create({retry:3,onRequest({_request:t,options:s}){const r=Oe.get();if(!Be(r))throw new Error("Invalid auth");const{server:n,token:a,username:i,password:o}=r;s.baseURL=n,s.headers=a?{"X-Auth-Token":a}:{Authorization:`Basic ${btoa(`${i}:${o}`)}`}},onRequestError({_request:t,_options:s,error:r}){console.error("Request error: ",r)},async onResponseError({_request:t,response:s,_options:r}){var i;s.status===401&&(localStorage.removeItem("auth"),await Xt.navigate("/login"));const a=((i=s._data)==null?void 0:i.error_message)??s.statusText;throw console.error("Response error: ",a),new Error(a)}}),k=ar();k.get=t=>k(t,{method:"GET"});k.post=(t,s)=>k(t,{method:"POST",body:s});k.put=(t,s)=>k(t,{method:"PUT",body:s});const ir=async()=>k.get("/v1/categories"),or=async t=>k.post("/v1/categories",{title:t}),lr=async t=>k.raw(`/v1/categories/${t}`,{method:"DELETE"}),cr=async(t,s,r=!1)=>{const n={title:s,hide_globally:r?"on":void 0};return k.put(`/v1/categories/${t}`,n)},dr=async t=>k.put(`/v1/categories/${t}/mark-all-as-read`),Ft={articleWidth:90,fontSize:1.05,homePage:"all",layout:"large",markReadOnScroll:!1,orderBy:"created_at",orderDirection:"desc",pageSize:100,removeDuplicates:"none",showAllFeeds:!1,showDetailedRelativeTime:!1,showFeedIcon:!0,showStatus:"unread",theme:"light",themeColor:"Blue"},_=ut("settings",Ft,{encode:JSON.stringify,decode:JSON.parse}),V=t=>_.get()[t],q=t=>_.set({..._.get(),...t}),ur=()=>_.set(Ft);B.extend(Qt);B.extend(Zt);B.extend(es);const hr=t=>B(t).isAfter(B().subtract(24,"hour")),mr=()=>B().subtract(24,"hour").unix(),Tt=(t,s)=>{if(!s){const f=B(t).fromNow();return f==="a few seconds ago"?"just now":f}const r=B(),a=B(t).diff(r),i=B.duration(Math.abs(a)),o=i.years(),l=i.months(),c=i.days(),d=i.hours(),h=i.minutes(),m=[];if(o>0&&m.push(`${o} year${o>1?"s":""}`),l>0&&m.push(`${l} month${l>1?"s":""}`),c>0&&m.push(`${c} day${c>1?"s":""}`),d>0&&m.push(`${d} hour${d>1?"s":""}`),h>0&&m.push(`${h} minute${h>1?"s":""}`),m.length===0)return"just now";const w=m.join(" ");return a>0?`in ${w}`:`${w} ago`},fr=()=>B().utc().format("YYYY-MM-DDTHH:mm:ss.SSSSSSZ"),Ee=async(t,s)=>k.put("/v1/entries",{entry_ids:t,status:s}),pr=async t=>k.put(`/v1/entries/${t}/bookmark`),gr=async t=>k.get(`/v1/entries/${t}/fetch-content`),ne=(t,s={})=>{const{baseUrl:r,orderField:n,offset:a,limit:i,status:o}=t,l=V("orderDirection"),c=new URLSearchParams({order:n,direction:l,offset:a,limit:i,...s});return o&&c.append("status",o),`${r}?${c}`},xr=async(t=0,s=null)=>{const r=V("orderBy"),n=V("pageSize"),a=V("showAllFeeds"),i={baseUrl:"/v1/entries",orderField:r,offset:t,limit:n,status:s},o={globally_visible:!a};return k.get(ne(i,o))},ye=async(t=0,s=null,r=null)=>{const n=V("orderBy"),a=r??V("pageSize"),i=V("showAllFeeds"),o=mr(),l={baseUrl:"/v1/entries",orderField:n,offset:t,limit:a,status:s},c={globally_visible:!i,published_after:o};return k.get(ne(l,c))},It=async(t=0,s=null)=>{const r=V("pageSize"),n={baseUrl:"/v1/entries",orderField:"changed_at",offset:t,limit:r,status:s},a={starred:"true"};return k.get(ne(n,a))},At=async(t=0)=>{const s=V("pageSize"),r={baseUrl:"/v1/entries",orderField:"changed_at",offset:t,limit:s,status:"read"};return k.get(ne(r))},yr=async()=>k.get("/v1/feeds"),jr=async()=>k.get("/v1/feeds/counters"),br=async t=>k.raw(`/v1/feeds/${t}/refresh`,{method:"PUT"}),wr=async()=>k.raw("/v1/feeds/refresh",{method:"PUT"}),vr=async(t,s,r)=>k.post("/v1/feeds",{feed_url:t,category_id:s,crawler:r}),Sr=async t=>k.raw(`/v1/feeds/${t}`,{method:"DELETE"}),nt=async(t,s)=>{const{categoryId:r,title:n,siteUrl:a,feedUrl:i,hidden:o,disabled:l,isFullText:c}=s;return k.put(`/v1/feeds/${t}`,{category_id:r,title:n,site_url:a,feed_url:i,hide_globally:o,disabled:l,crawler:c})},Cr=async t=>k.put(`/v1/feeds/${t}/mark-all-as-read`),kr=async()=>k.get("/v1/me"),Fr=async()=>k.get("/v1/version"),Tr=async()=>{const t=await kr();return k.put(`/v1/users/${t.data.id}/mark-all-as-read`)},Ir=(t,s)=>{const r=t.split("."),n=s.split(".");for(let a=0;a<Math.max(r.length,n.length);a++){const i=r[a]||"0",o=n[a]||"0",l=i.localeCompare(o,void 0,{numeric:!0});if(l!==0)return l}return 0},z=Te({isAppDataReady:!1,unreadInfo:{},unreadTodayCount:0,starredCount:0,historyCount:0,feedsData:[],categoriesData:[],versionNewerThan2_2_0:!1}),He=K(z,t=>{const{unreadInfo:s,feedsData:r}=t;return r.map(a=>({...a,unreadCount:s[a.id]??0})).sort((a,i)=>a.title.localeCompare(i.title,"en"))}),ue=K([z,He],(t,s)=>{const{categoriesData:r}=t;return r.map(a=>{const i=s.filter(o=>o.category.id===a.id);return{...a,unreadCount:i.reduce((o,l)=>o+(l.unreadCount??0),0),feedCount:i.length}}).sort((a,i)=>a.title.localeCompare(i.title,"en"))}),Et=K(ue,t=>t.filter(s=>s.hide_globally).map(s=>s.id)),Nt=K([He,Et],(t,s)=>t.filter(r=>r.hide_globally||s.includes(r.category.id)).map(r=>r.id)),Rt=K([He,Nt,_],(t,s,r)=>{const{showAllFeeds:n}=r;return t.filter(a=>n||!s.includes(a.id))}),Mt=K(Rt,t=>t.reduce((s,r)=>{const{id:n}=r.category;return s[n]||(s[n]=[]),s[n].push(r),s},{})),Ar=K([z,Rt],(t,s)=>{const{unreadInfo:r}=t;return Object.entries(r).reduce((n,[a,i])=>s.some(o=>o.id===Number(a))?n+i:n,0)}),je=D(z,"categoriesData"),Z=D(z,"feedsData"),Ne=D(z,"historyCount"),Re=D(z,"isAppDataReady"),Me=D(z,"starredCount"),Lt=D(z,"unreadInfo"),Pt=D(z,"unreadTodayCount"),Er=D(z,"versionNewerThan2_2_0"),qe=async()=>{Re(!1);const t=await Promise.all([jr(),ye(0,"unread"),It(),At(),yr(),ir(),Fr()]),[s,r,n,a,i,o,l]=t,c=i.reduce((d,h)=>(d[h.id]=s.unreads[h.id]??0,d),{});Lt(c),Pt(r.total??0),Me(n.total??0),Ne(a.total??0),Z(i),je(o),Re(!0),Er(Ir(l.version,"2.2.0")>=0)},Dt=(t,s)=>{const r=s.map(n=>n.id);return t.map(n=>r.includes(n.id)&&s.find(i=>i.id===n.id)||n)},Le=(t,s)=>{const r={};let n=0;const a=t.filter(c=>c.status!==s);if(a.length===0)return;Ne(s==="read"?c=>c+a.length:c=>Math.max(0,c-a.length));for(const c of a){const d=c.feed.id,h=hr(c.published_at),m=s==="read"?-1:1;r[d]=(r[d]??0)+m,n+=h?m:0}Pt(c=>Math.max(0,c+n)),Lt(c=>{const d={...c};for(const[h,m]of Object.entries(r))d[h]=Math.max(0,(d[h]??0)+m);return d});const i=a.map(c=>({...c,status:s})),{activeContent:o}=L.get(),l=i.find(c=>c.id===(o==null?void 0:o.id));l&&W(l),he(c=>Dt(c,i))},We=()=>{const{activeContent:t}=g(L),s=(o,l)=>{Le([o],l)},r=(o,l)=>{l?(Me(d=>d+1),ts({particleCount:100,angle:120,spread:70,origin:{x:1,y:1}})):Me(d=>Math.max(0,d-1));const c={...o,starred:l};t&&W(c),he(d=>Dt(d,[c]))};return{handleEntryStatusUpdate:s,handleFetchContent:async()=>{try{const o=await gr(t.id);b.success("Fetched content successfully"),W({...t,content:o.content})}catch{b.error("Failed to fetch content, please try again later")}},handleToggleStarred:async o=>{const l=!o.starred;r(o,l),pr(o.id).catch(()=>{b.error(`Failed to ${l?"star":"unstar"} entry, please try again later`),r(o,!l)})},handleToggleStatus:async o=>{const l=o.status,c=l==="read"?"unread":"read";s(o,c),Ee([o.id],c).catch(()=>{b.error(`Failed to mark entry as ${c}, please try again later`),s(o,l)})}}},Nr=(t,s)=>{if(t.length===0||s==="none")return t;const r=t.map((d,h)=>({id:d.id,index:h})),n=new Map,a=new Map,i=new Map,o=[],l=t.slice().sort((d,h)=>d.id-h.id).filter(d=>{const{hash:h,title:m,url:w,id:f}=d;switch(s){case"hash":if(n.has(h))return o.push(d),!1;n.set(h,f);break;case"title":if(a.has(m))return o.push(d),!1;a.set(m,f);break;case"url":if(i.has(w))return o.push(d),!1;i.set(w,f);break;default:return!0}return!0}),c=o.filter(d=>d.status==="unread").map(d=>d.id);return c.length>0&&(Le(o,"read"),Ee(c,"read").catch(()=>{b.error("Failed to mark duplicate entries as read"),Le(o,"unread")})),l.sort((d,h)=>{const m=r.find(f=>f.id===d.id).index,w=r.find(f=>f.id===h.id).index;return m-w})},Rr=t=>{const s=new Array(t.length).fill(0);let r=0,n=1;for(;n<t.length;)t[n]===t[r]?(r++,s[n]=r,n++):r!==0?r=s[r-1]:(s[n]=0,n++);return s},pe=(t,s,r=!0)=>{const n=r?t.toLowerCase():t,a=r?s.toLowerCase():s;if(a.length===0)return 0;const i=Rr(a);let o=0,l=0;for(;o<n.length;)if(n[o]===a[l]?(o++,l++):l!==0?l=i[l-1]:o++,l===a.length)return o-l;return-1},Mr=t=>{const s=[],r=[];let n=[];const a=[],i=t.match(/([-+|]?)\s*"([^"]+)"/g);let o=t;i&&(n=i.map(c=>{const d=c.trim()[0],h=c.match(/"([^"]+)"/)[1];switch(d){case"-":r.push(h);break;case"+":s.push(h);break;case"|":a.push([h]);break;default:s.push(h);break}return h}),o=t.replace(/([-+|]?)\s*"([^"]+)"/g,""));const l=o.split(/\s+/);for(const c of l){const d=c.replace(/^-|\+|\|$/,"");if(c.startsWith("-")&&d)r.push(d);else if(c.startsWith("+")&&d)s.push(d);else if(c.includes("|")){const h=c.split("|").filter(m=>m);h.length>0&&a.push(h)}else d&&s.push(d)}return{includeTerms:s,excludeTerms:r,exactPhrases:n,orConditions:a}},Lr=(t,s,r=[],n=!0)=>{const{includeTerms:a,excludeTerms:i,exactPhrases:o,orConditions:l}=Mr(s);return t.filter(c=>r.some(d=>{const h=c[d];if(typeof h!="string")return!1;const m=n?h.toLowerCase():h;if(i.some(j=>pe(m,j,n)!==-1)||o.length>0&&!o.some(j=>pe(m,j,n)!==-1))return!1;const w=a.every(j=>pe(m,j,n)!==-1),f=l.length===0||l.some(j=>j.some(C=>pe(m,C,n)!==-1));return w&&f}))},Pr=(t,s,r=[],n=!0)=>{try{if(!Array.isArray(t)||t.length===0)throw new Error("Invalid data input");if(typeof s!="string"||s.trim().length===0)throw new Error("Invalid query input");return Lr(t,s,r,n)}catch(a){return console.error(a.message),[]}},be=(t,s)=>t.toLowerCase().includes(s.toLowerCase()),Dr=(t,s,r)=>r?Pr(t,r,[s]):t,L=Te({activeContent:null,entries:[],filterString:"",filterType:"Title",infoFrom:V("homePage"),isArticleFocused:!1,isArticleListReady:!1,offset:0,total:0}),Ke=K(L,t=>{const{entries:s,total:r}=t;return s.length<r}),Ge=K([L,z,Nt,_],(t,s,r,n)=>{const{entries:a,filterString:i,filterType:o,infoFrom:l}=t,c=Dr(a,o,i),{versionNewerThan2_2_0:d}=s,{removeDuplicates:h,showAllFeeds:m}=n,w=!["starred","history"].includes(l),f=C=>d||m||!r.includes(C.feed.id),j=w?c.filter(f):c;return h==="none"||["starred","history"].includes(l)?j:Nr(j,h)}),W=D(L,"activeContent"),he=D(L,"entries"),ke=D(L,"filterString"),Fe=D(L,"filterType"),_r=D(L,"infoFrom"),re=D(L,"isArticleFocused"),at=D(L,"isArticleListReady"),_t=D(L,"offset"),Ur=D(L,"total"),$r=t=>{const s=/^(?:http|https):\/\/((?!(\d+\.){3}\d+)([^/?#]+))/,r=t.match(s);return r?r[1]:null},it=t=>{const s=$r(t);if(s){const r=s.split(".");if(r.length>=2)return r.slice(-2).join(".")}return null},Ut=({feed:t,className:s="feed-icon"})=>{const n=`https://icons.duckduckgo.com/ip3/${it(t.site_url)??it(t.feed_url)}.ico`;return e.jsx("img",{className:s,src:n,alt:"Feed icon"})},$t=J.Item,Vr=({category:t,path:s})=>{var o;const n=(o=g(Mt)[t.id])==null?void 0:o.reduce((l,c)=>l+c.unreadCount,0),a=ee(),i=()=>{a(`/category/${t.id}`),W(null)};return e.jsxs("div",{className:Ie("category-title",{"active-subMenu":s===`/category/${t.id}`,"inactive-subMenu":s!==`/category/${t.id}`}),onClick:i,onKeyDown:l=>{(l.key==="Enter"||l.key===" ")&&i()},tabIndex:0,role:"button",style:{cursor:"pointer"},children:[e.jsx(y.Ellipsis,{expandable:!1,showTooltip:!0,style:{width:n?"80%":"100%",fontWeight:500},children:t.title}),n>0&&e.jsx(y.Ellipsis,{className:"unread-count",expandable:!1,style:{fontWeight:500},children:n})]})},zr=({count:t})=>e.jsx(y.Ellipsis,{className:"item-count",expandable:!1,children:t||""}),ge=({path:t,Icon:s,label:r,count:n})=>{const a=_e(),i=ee(),o=a.pathname===t,l=()=>{i(t),W(null)};return e.jsx($t,{onClick:l,className:Ie("arco-menu-item",{"arco-menu-selected":o}),children:e.jsxs("div",{className:"custom-menu-item",children:[e.jsxs("span",{children:[e.jsx(s,{}),r]}),e.jsx(zr,{count:n})]})},t)},Vt=()=>{const{homePage:t,showAllFeeds:s,showFeedIcon:r}=g(_),{historyCount:n,isAppDataReady:a,starredCount:i,unreadTodayCount:o}=g(z),l=g(ue),c=g(Mt),d=g(Et),h=g(Ar),m=_e(),w=ee(),[f,j]=p.useState([`/${t}`]),C=m.pathname;p.useEffect(()=>{j([C])},[C]);const U=()=>e.jsxs(e.Fragment,{children:[e.jsx(ge,{path:"/all",Icon:rs,label:"All",count:h}),e.jsx(ge,{path:"/today",Icon:ns,label:"Today",count:o}),e.jsx(ge,{path:"/starred",Icon:Ue,label:"Starred",count:i}),e.jsx(ge,{path:"/history",Icon:as,label:"History",count:n})]}),v=E=>{var I;return(I=c[E])==null?void 0:I.map(N=>e.jsx($t,{style:{position:"relative",overflow:"hidden"},onClick:u=>{u.stopPropagation(),w(`/feed/${N.id}`),W(null)},children:e.jsxs("div",{className:"custom-menu-item",children:[e.jsxs(y.Ellipsis,{expandable:!1,showTooltip:!0,style:{width:N.unreadCount?"80%":"100%",paddingLeft:"20px",boxSizing:"border-box"},children:[r&&e.jsx(Ut,{feed:N,className:"feed-icon-sidebar"}),N.title]}),N.unreadCount!==0&&e.jsx(y.Ellipsis,{className:"item-count",expandable:!1,children:N.unreadCount})]})},`/feed/${N.id}`))},S=()=>l.filter(E=>s||!d.includes(E.id)).map(E=>e.jsx(Qe.Item,{name:`/category/${E.id}`,style:{position:"relative",overflow:"hidden"},header:e.jsx(Vr,{category:E,path:C}),expandIcon:e.jsx(is,{}),children:v(E.id)},E.id));return e.jsxs(J,{autoScrollIntoView:!0,hasCollapseButton:!1,selectedKeys:f,style:{width:"240px",height:"100%"},children:[e.jsxs("div",{className:"menu-header",children:[e.jsx(mt,{className:"avatar",size:32,children:e.jsx(ss,{style:{color:"var(--color-bg-1)"}})}),e.jsx(y.Title,{heading:6,style:{margin:0},children:"ReactFlux"})]}),e.jsx(y.Title,{className:"section-title",heading:6,style:{paddingLeft:"12px"},children:"Articles"}),e.jsx(we,{loading:!a,animation:!0,text:{rows:3}}),a&&U(),e.jsx(y.Title,{className:"section-title",heading:6,style:{paddingLeft:"12px"},children:"Feeds"}),e.jsx(we,{loading:!a,animation:!0,text:{rows:6}}),a&&e.jsx(Qe,{triggerRegion:"icon",bordered:!1,children:S()})]})},Or=()=>{const{showAllFeeds:t,theme:s}=g(_),r=ee(),n=_e().pathname,{setAddFeedModalVisible:a,setSettingsModalVisible:i}=ze(),{isBelowLarge:o}=de(),[l,c]=p.useState(!1),[d,h]=p.useState(!1),[m,w]=p.useState(!1);p.useEffect(()=>{o||c(!1)},[o]),p.useEffect(()=>{n&&c(!1)},[n]);const f=()=>{q({showAllFeeds:!t})},j=()=>{q({theme:s==="light"?"dark":"light"})},C=()=>{ur(),h(!1)},U=()=>{rr(),Re(!1),r("/login"),b.success("Successfully logged out")},v=()=>s==="dark"?e.jsx(fs,{}):s==="system"?e.jsx(ps,{}):e.jsx(gs,{});return e.jsxs("div",{className:"header",children:[e.jsx("div",{className:"brand",children:e.jsx(M,{className:"trigger",onClick:()=>c(!l),shape:"circle",size:"small",children:e.jsx(os,{})})}),e.jsx(ls,{className:"sidebar-drawer",visible:l,title:null,footer:null,closable:!1,onCancel:()=>c(!1),placement:"left",width:240,children:e.jsx(Vt,{})}),e.jsx("div",{className:"button-group",children:e.jsxs(ve,{size:16,children:[e.jsx(le,{content:"Add a feed",mini:!0,children:e.jsx(M,{shape:"circle",size:"small",type:"primary",icon:e.jsx(ft,{}),onClick:()=>a(!0)})}),e.jsx(le,{content:t?"Hide some feeds":"Show all feeds",mini:!0,children:e.jsx(M,{shape:"circle",size:"small",icon:t?e.jsx(cs,{}):e.jsx(ds,{}),onClick:f})}),e.jsx(M,{shape:"circle",size:"small",icon:e.jsx(us,{}),onClick:()=>window.open("https://github.com/electh/ReactFlux","_blank")}),e.jsx(Ze,{droplist:e.jsx(J,{defaultSelectedKeys:[s],className:"theme-menu",children:["light","dark","system"].map(S=>e.jsxs(J.Item,{className:"theme-menu-item",onClick:()=>q({theme:S}),children:[S.charAt(0).toUpperCase()+S.slice(1),s===S&&e.jsx(pt,{style:{marginLeft:8}})]},S))}),trigger:"hover",position:"bottom",children:e.jsx(M,{icon:v(),shape:"circle",size:"small",onClick:j})}),e.jsx(Ze,{droplist:e.jsxs(J,{children:[e.jsxs(J.Item,{onClick:()=>i(!0),children:[e.jsx(hs,{className:"icon-right"}),"Settings"]},"0"),e.jsxs(J.Item,{onClick:()=>h(!0),children:[e.jsx(Se,{className:"icon-right"}),"Reset Settings"]},"1"),e.jsxs(J.Item,{onClick:()=>w(!0),children:[e.jsx(ms,{className:"icon-right"}),"Logout"]},"2")]}),trigger:"click",position:"br",children:e.jsx(mt,{size:28,style:{cursor:"pointer"},children:e.jsx(gt,{})})})]})}),e.jsx(Q,{title:"Confirm Reset",visible:d,onOk:C,onCancel:()=>h(!1),children:e.jsx("p",{children:"Are you sure you want to reset your settings? This action cannot be undone."})}),e.jsx(Q,{title:"Confirm Logout",visible:m,onOk:U,onCancel:()=>w(!1),children:e.jsx("p",{children:"Are you sure you want to logout?"})})]})},Pe={Red:{light:"#F53F3F",dark:"#F76965"},Orange:{light:"#F77234",dark:"#F9925A"},Green:{light:"#00B42A",dark:"#27C346"},Blue:{light:"#165DFF",dark:"#3C7EFF"},Purple:{light:"#722ED1",dark:"#8E51DA"},Gold:{light:"#F7BA1E",dark:"#F9CC44"},Cyan:{light:"#14C9C9",dark:"#3FD4CF"},Magenta:{light:"#F5319D",dark:"#F756A9"}},De=t=>{const s=Pe[t]||Pe.Blue,r=window.matchMedia("(prefers-color-scheme: dark)").matches,n=V("theme");return(n==="system"?r:n==="dark")?s.dark:s.light},zt=t=>{xs(De(t),{list:!0}).map(ys).forEach((r,n)=>{document.body.style.setProperty(`--primary-${n+1}`,r)})},Br=()=>{const{articleWidth:t,fontSize:s,layout:r,showDetailedRelativeTime:n,showFeedIcon:a,themeColor:i}=g(_),o=l=>{q(l),l.themeColor&&zt(l.themeColor)};return e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"setting-row",children:[e.jsxs("div",{children:[e.jsx(y.Title,{heading:6,style:{marginTop:0},children:"Accent color"}),e.jsx(y.Text,{type:"secondary",children:"Choose your accent color"})]}),e.jsx("div",{style:{display:"flex"},children:Object.keys(Pe).map(l=>e.jsx(le,{content:l,children:e.jsx("div",{style:{width:"18px",height:"18px",borderRadius:"50%",margin:"2px",backgroundColor:De(l),cursor:"pointer",border:"3px solid var(--color-bg-3)",outline:l===i?`1px solid ${De(l)}`:"none"},onClick:()=>o({themeColor:l}),onKeyDown:c=>{(c.key==="Enter"||c.key===" ")&&o({themeColor:l})},"aria-label":`Change theme color to ${l}`})},l))})]}),e.jsx(H,{}),e.jsxs("div",{className:"setting-row",children:[e.jsxs("div",{children:[e.jsx(y.Title,{heading:6,style:{marginTop:0},children:"Compact article list"}),e.jsx(y.Text,{type:"secondary",children:"Use small thumbnail in article list"})]}),e.jsx("div",{children:e.jsx(Y,{checked:r==="small",onChange:l=>o({layout:l?"small":"large"})})})]}),e.jsx(H,{}),e.jsxs("div",{className:"setting-row",children:[e.jsxs("div",{children:[e.jsx(y.Title,{heading:6,style:{marginTop:0},children:"Show detailed relative time"}),e.jsx(y.Text,{type:"secondary",children:"Show detailed relative time in article list"})]}),e.jsx("div",{children:e.jsx(Y,{checked:n,onChange:l=>o({showDetailedRelativeTime:l})})})]}),e.jsx(H,{}),e.jsxs("div",{className:"setting-row",children:[e.jsxs("div",{children:[e.jsx(y.Title,{heading:6,style:{marginTop:0},children:"Show feed icon"}),e.jsx(y.Text,{type:"secondary",children:"Show feed icon in feed list and article list"})]}),e.jsx("div",{children:e.jsx(Y,{checked:a,onChange:l=>o({showFeedIcon:l})})})]}),e.jsx(H,{}),e.jsxs("div",{className:"setting-row",children:[e.jsxs("div",{children:[e.jsx(y.Title,{heading:6,style:{marginTop:0},children:"Font size"}),e.jsx(y.Text,{type:"secondary",children:"Adjust article text size"})]}),e.jsx("div",{children:e.jsxs(ve,{children:[e.jsx(y.Text,{style:{fontSize:"0.75rem"},children:"A"}),e.jsx(et,{formatTooltip:l=>`${l}rem`,max:1.25,min:.75,showTicks:!0,step:.05,style:{width:200},value:s,onChange:l=>o({fontSize:l})}),e.jsx(y.Text,{style:{fontSize:"1.25rem"},children:"A"})]})})]}),e.jsx(H,{}),e.jsxs("div",{className:"setting-row",children:[e.jsxs("div",{children:[e.jsx(y.Title,{heading:6,style:{marginTop:0},children:"Article width"}),e.jsx(y.Text,{type:"secondary",children:"Adjust article width"})]}),e.jsx("div",{children:e.jsxs(ve,{children:[e.jsx(y.Text,{children:"60%"}),e.jsx(et,{formatTooltip:l=>`${l}%`,max:90,min:60,showTicks:!0,step:10,style:{width:160},value:t,onChange:l=>o({articleWidth:l})}),e.jsx(y.Text,{children:"90%"})]})})]})]})},Hr=()=>{const t=g(ue),[s]=P.useForm(),[r,n]=p.useState(!1),[a,i]=p.useState(""),[o,l]=p.useState({}),[c,d]=p.useState(!1),h=async()=>{if(a.trim()){try{const f=await or(a);je(j=>[...j,{...f}]),b.success("Category added successfully")}catch(f){console.error("Failed to add category: ",f),b.error("Failed to add category")}i(""),d(!1)}},m=async(f,j,C)=>{try{const U=await cr(f,j,C);Z(v=>v.map(S=>S.category.id===f?{...S,category:{...S.category,title:j,hide_globally:C}}:S)),je(v=>v.map(S=>S.id===f?{...S,...U}:S)),b.success("Category updated successfully")}catch{b.error("Failed to update category")}n(!1),s.resetFields()},w=async f=>{try{(await lr(f.id)).status===204?(je(C=>C.filter(U=>U.id!==f.id)),b.success(`Deleted category: ${f.title}`)):b.error(`Failed to delete category: ${f.title}`)}catch(j){console.error(`Failed to delete category: ${f.title}`,j),b.error(`Failed to delete category: ${f.title}`)}};return e.jsxs(e.Fragment,{children:[e.jsxs("div",{children:[t.map(f=>e.jsx(ce,{className:"tag-style",closable:f.feedCount===0,size:"medium",onClick:()=>{l(f),n(!0),s.setFieldsValue({title:f.title})},onClose:async j=>{j.stopPropagation(),await w(f)},children:f.title},f.id)),c?e.jsx(O,{autoFocus:!0,className:"input-style",onBlur:h,onChange:i,onPressEnter:h,size:"small",value:a}):e.jsx(ce,{className:"add-category-tag",icon:e.jsx(ft,{}),onClick:()=>d(!0),size:"medium",tabIndex:0,children:"Add"})]}),o&&e.jsx(Q,{className:"modal-style",onOk:s.submit,title:"Edit Category",unmountOnExit:!0,visible:r,onCancel:()=>{n(!1),s.resetFields()},children:e.jsxs(P,{form:s,layout:"vertical",onSubmit:f=>m(o.id,f.title,f.hidden),labelCol:{style:{flexBasis:90}},wrapperCol:{style:{flexBasis:"calc(100% - 90px)"}},children:[e.jsx(P.Item,{label:"Title",field:"title",rules:[{required:!0}],children:e.jsx(O,{placeholder:"Please input category title"})}),e.jsx(P.Item,{label:"Hidden",field:"hidden",initialValue:o.hide_globally,triggerPropName:"checked",rules:[{type:"boolean"}],children:e.jsx(Y,{})})]})})]})},qr=t=>new Promise(s=>setTimeout(s,t)),{Paragraph:Wr}=y,Ot=xt(""),ot=D(Ot),Bt=K([z,Ot],(t,s)=>{const{feedsData:r}=t;return[...r].sort((n,a)=>n.disabled&&!a.disabled?1:!n.disabled&&a.disabled?-1:0).sort((n,a)=>a.parsing_error_count-n.parsing_error_count).filter(n=>be(n.title,s)||be(n.site_url,s)||be(n.feed_url,s))}),Kr=K(Bt,t=>t.map(s=>({category:s.category,checked_at:s.checked_at,crawler:s.crawler,disabled:s.disabled,feed_url:s.feed_url,hidden:s.hide_globally,key:s.id,parsing_error_count:s.parsing_error_count,site_url:s.site_url,title:s.title}))),lt=(t,s,r=null)=>r===null||r===t.id?{...t,parsing_error_count:s?0:t.parsing_error_count+1,checked_at:fr()}:t,Gr=()=>{const t=g(ue),{showDetailedRelativeTime:s}=g(_),r=g(Bt),n=g(Kr),[a,i]=p.useState(!1),[o]=P.useForm(),[l,c]=p.useState(!1),[d,h]=p.useState(""),[m,w]=p.useState(null),{isBelowMedium:f}=de();p.useEffect(()=>{ot("")},[]);const j=u=>{w(u),c(!0),o.setFieldsValue({category:u.category.id,title:u.title,siteUrl:u.site_url,feedUrl:u.feed_url,hidden:u.hidden,disabled:u.disabled,crawler:u.crawler})},C=async(u,x,T=!0)=>{try{const A=(await u()).status===204;return T&&(A?b.success("Refreshed"):b.error("Failed to refresh")),Z(G=>G.map(te=>x(te,A))),A}catch{return T&&b.error("Failed to refresh"),Z(A=>A.map(G=>x(G,!1))),!1}},U=async(u,x=!0)=>{const T=u.id||u.key;return C(()=>br(T),(F,A)=>lt(F,A,T),x)},v=async()=>{try{const u=await Promise.all(r.map(async x=>{const T=new URL(x.feed_url).hostname,F=x.feed_url.replace(T,d),A=await nt(x.id,{feedUrl:F});return{...x,...A}}));Z(x=>x.map(T=>u.find(F=>F.id===T.id)||T)),b.success("Bulk update successfully"),i(!1)}catch{b.error("Failed to bulk update, please try again")}},S=()=>{const[u,x]=p.useState(!1),T=async()=>{x(!1),await C(wr,lt)},F=async()=>{x(!1);const G=r.filter(X=>X.parsing_error_count>0);b.success("Starting refresh of error feeds, please wait");const te=await Promise.all(G.map(async X=>{const R=await U(X,!1);return await qr(500),R})),me=te.filter(Boolean).length,fe=te.length-me;b.success(`Feeds refreshed. Success: ${me}, Failure: ${fe}`)},A=()=>x(!1);return e.jsxs(e.Fragment,{children:[e.jsx(M,{icon:e.jsx(Se,{}),shape:"circle",onClick:()=>x(!0)}),e.jsx(Q,{className:"edit-modal",onCancel:A,title:"Refresh Feeds",visible:u,footer:[e.jsx(M,{onClick:A,children:"Cancel"},"cancel"),e.jsx(M,{type:"outline",onClick:F,children:"Error Feeds"},"error"),e.jsx(M,{type:"primary",onClick:T,children:"All Feeds"},"all")],children:e.jsx("p",{children:"Do you want to refresh all feeds or just the ones with errors?"})})]})},E=async u=>{try{(await Sr(u.key)).status===204?(Z(T=>T.filter(F=>F.id!==u.key)),b.success(`Unfollowed feed: ${u.title}`)):b.error(`Failed to unfollow feed: ${u.title}`)}catch(x){console.error(`Failed to unfollow feed: ${u.title}`,x),b.error(`Failed to unfollow feed: ${u.title}`)}},I=[{title:"Title",dataIndex:"title",sorter:(u,x)=>u.title.localeCompare(x.title,"en"),render:(u,x)=>{const T=x.parsing_error_count;let F=x.disabled?`ðŸš« ${u}`:u;T>0&&(F=`âš ï¸ ${u}`);const A=e.jsxs("div",{children:[u,T>0&&e.jsxs(e.Fragment,{children:[e.jsx("br",{}),"âš ï¸ Parsing error count: ",T]})]});return e.jsx(y.Ellipsis,{expandable:!1,children:e.jsx(le,{mini:!0,content:A,children:F})})}},!f&&{title:"Feed URL",dataIndex:"feed_url",sorter:(u,x)=>u.feed_url.localeCompare(x.feed_url,"en"),render:u=>e.jsx(y.Ellipsis,{expandable:!1,showTooltip:!0,children:u})},{title:"Category",dataIndex:"category.title",sorter:(u,x)=>u.category.title.localeCompare(x.category.title,"en"),render:u=>e.jsx(y.Ellipsis,{expandable:!1,showTooltip:!0,children:e.jsx(ce,{children:u})})},!f&&{title:"Checked at",dataIndex:"checked_at",sorter:(u,x)=>u.checked_at.localeCompare(x.checked_at,"en"),render:u=>e.jsx(y.Ellipsis,{expandable:!1,children:Tt(u,s)})},{title:"Actions",dataIndex:"op",fixed:"right",width:100,render:(u,x)=>e.jsxs(ve,{children:[e.jsx("button",{"aria-label":"Edit this feed",className:"list-item-action",onClick:()=>j(x),type:"button",children:e.jsx(tt,{})}),e.jsx("button",{"aria-label":"Refresh this feed",className:"list-item-action",onClick:()=>U(x),type:"button",children:e.jsx(Se,{})}),e.jsx(jt,{focusLock:!0,position:"left",title:"Unfollowï¼Ÿ",onOk:()=>E(x),children:e.jsx("span",{className:"list-item-action",children:e.jsx(js,{})})})]})}].filter(Boolean),N=async(u,x)=>{try{const T=await nt(u,x);Z(F=>F.map(A=>A.id===u?{...A,...T}:A)),b.success("Feed updated successfully"),c(!1),o.resetFields()}catch{b.error("Failed to update feed")}};return e.jsxs(e.Fragment,{children:[e.jsxs("div",{style:{alignItems:"center",display:"flex",width:"100%"},children:[e.jsx("div",{style:{display:"flex",flex:1,justifyContent:"center",minWidth:0},children:e.jsx(O.Search,{className:"search-input",placeholder:"Search title or site URL or feed URL",searchButton:!0,onChange:ot})}),e.jsxs("div",{style:{display:"flex",gap:16,paddingBottom:16,paddingLeft:16},children:[e.jsx(M,{icon:e.jsx(tt,{}),shape:"circle",onClick:()=>i(!0)}),e.jsxs(Q,{className:"edit-modal",onOk:v,title:"Bulk Update Hosts",visible:a,onCancel:()=>{i(!1),h("")},children:[e.jsxs(Wr,{children:["This will bulk update filtered feeds' hosts.",e.jsx("br",{}),"Only recommended for RssHub."]}),e.jsx(O,{placeholder:"rsshub.app",value:d,onChange:u=>h(u)})]}),e.jsx(S,{})]})]}),e.jsx(yt,{borderCell:!0,className:"feed-table",columns:I,data:n,pagePosition:"bottomCenter",scroll:{x:!0},size:"small"}),m&&e.jsx(Q,{className:"edit-modal",onOk:o.submit,title:"Edit Feed",unmountOnExit:!0,visible:l,onCancel:()=>{c(!1),o.resetFields()},children:e.jsxs(P,{form:o,labelCol:{span:7},layout:"vertical",wrapperCol:{span:17},onSubmit:async u=>{const x={categoryId:u.category,title:u.title,siteUrl:u.siteUrl.trim(),feedUrl:u.feedUrl.trim(),hidden:u.hidden,disabled:u.disabled,isFullText:u.crawler};x.feedUrl?await N(m.key,x):b.error("Feed URL cannot be empty")},children:[e.jsx(P.Item,{label:"Category",required:!0,field:"category",rules:[{required:!0}],children:e.jsx($,{placeholder:"Please select",children:t.map(u=>e.jsx($.Option,{value:u.id,children:u.title},u.id))})}),e.jsx(P.Item,{label:"Title",field:"title",rules:[{required:!0}],children:e.jsx(O,{placeholder:"Please input feed title"})}),e.jsx(P.Item,{label:"Site URL",field:"siteUrl",rules:[{required:!0}],children:e.jsx(O,{placeholder:"Please input site URL"})}),e.jsx(P.Item,{label:"Feed URL",field:"feedUrl",rules:[{required:!0}],children:e.jsx(O,{placeholder:"Please input feed URL"})}),e.jsx(P.Item,{label:"Hidden",field:"hidden",initialValue:m.hidden,triggerPropName:"checked",rules:[{type:"boolean"}],children:e.jsx(Y,{})}),e.jsx(P.Item,{label:"Disabled",field:"disabled",initialValue:m.disabled,triggerPropName:"checked",rules:[{type:"boolean"}],children:e.jsx(Y,{})}),e.jsx(P.Item,{label:"Fetch original content",field:"crawler",tooltip:e.jsx("div",{children:"Only affects newly retrieved articles"}),triggerPropName:"checked",rules:[{type:"boolean"}],children:e.jsx(Y,{})})]})})]})},Yr=()=>{const{homePage:t,markReadOnScroll:s,orderBy:r,pageSize:n,removeDuplicates:a}=g(_);return e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"setting-row",children:[e.jsxs("div",{children:[e.jsx(y.Title,{heading:6,style:{marginTop:0},children:"Default home page"}),e.jsx(y.Text,{type:"secondary",children:"Which page to show by default:"})]}),e.jsx("div",{children:e.jsxs($,{className:"input-select",onChange:i=>q({homePage:i}),placeholder:"Select page",value:t,children:[e.jsx($.Option,{value:"all",children:"All"}),e.jsx($.Option,{value:"today",children:"Today"}),e.jsx($.Option,{value:"starred",children:"Starred"}),e.jsx($.Option,{value:"history",children:"History"})]})})]}),e.jsx(H,{}),e.jsxs("div",{className:"setting-row",children:[e.jsxs("div",{children:[e.jsx(y.Title,{heading:6,style:{marginTop:0},children:"Entries order"}),e.jsx(y.Text,{type:"secondary",children:"What order to show entries:"})]}),e.jsx("div",{children:e.jsxs($,{className:"input-select",onChange:i=>q({orderBy:i}),placeholder:"Select order",value:r,children:[e.jsx($.Option,{value:"published_at",children:"Published at"}),e.jsx($.Option,{value:"created_at",children:"Created at"})]})})]}),e.jsx(H,{}),e.jsxs("div",{className:"setting-row",children:[e.jsxs("div",{children:[e.jsx(y.Title,{heading:6,style:{marginTop:0},children:"Entries per page"}),e.jsx(y.Text,{type:"secondary",children:"Show how many entries per page:"})]}),e.jsx("div",{children:e.jsx(bs,{className:"input-select",defaultValue:n,min:1,mode:"button",onChange:i=>q({pageSize:i}),size:"small"})})]}),e.jsx(H,{}),e.jsxs("div",{className:"setting-row",children:[e.jsxs("div",{children:[e.jsx(y.Title,{heading:6,style:{marginTop:0},children:"Remove duplicate articles"}),e.jsx(y.Text,{type:"secondary",children:"Automatically remove duplicate articles based on:"})]}),e.jsx("div",{children:e.jsxs($,{className:"input-select",onChange:i=>q({removeDuplicates:i}),placeholder:"Select option",value:a,children:[e.jsx($.Option,{value:"none",children:"None"}),e.jsx($.Option,{value:"hash",children:"Hash"}),e.jsx($.Option,{value:"title",children:"Title"}),e.jsx($.Option,{value:"url",children:"URL"})]})})]}),e.jsx(H,{}),e.jsxs("div",{className:"setting-row",children:[e.jsxs("div",{children:[e.jsx(y.Title,{heading:6,style:{marginTop:0},children:"Mark articles as read when scrolled off screen"}),e.jsx(y.Text,{type:"secondary",children:"Automatically mark articles as read when they are scrolled out of the visible screen area"})]}),e.jsx("div",{children:e.jsx(Y,{checked:s,onChange:i=>q({markReadOnScroll:i})})})]})]})},Xr=[{title:"Key",dataIndex:"keyName",render:t=>e.jsx(ce,{children:t})},{title:"Function",dataIndex:"description"}],Jr=[{key:"1",keyName:"Esc",description:"Exit the article view and return to the list."},{key:"2",keyName:"â†",description:"Navigate to the previous article in the list."},{key:"3",keyName:"Ctrl + â†",description:"Navigate to the previous unread article in the list."},{key:"4",keyName:"â†’",description:"Navigate to the next article in the list."},{key:"5",keyName:"Ctrl + â†’",description:"Navigate to the next unread article in the list."},{key:"6",keyName:"B",description:"Open the current article's link in a new browser tab."},{key:"7",keyName:"D",description:"Fetch and display the original content of the current article."},{key:"8",keyName:"M",description:"Toggle the read status of the current article."},{key:"9",keyName:"S",description:"Toggle the star status (bookmark) of the current article."},{key:"10",keyName:"V",description:"Open the photo slider for viewing all images in the current article."}],Qr=()=>e.jsx(yt,{borderCell:!0,columns:Xr,data:Jr,pagination:!1,size:"small",style:{margin:"0 auto",width:"90%"}}),Zr=()=>{const t=(s,r)=>e.jsxs("div",{style:{display:"flex",flexDirection:"column",alignItems:"center"},children:[s,e.jsx("div",{style:{fontSize:"12px"},children:r})]});return e.jsxs(se,{className:"custom-tabs",defaultActiveTab:"1",tabPosition:"top",animation:!0,children:[e.jsx(se.TabPane,{title:t(e.jsx(ws,{style:{fontSize:"20px"}}),"Feeds"),children:e.jsx(Gr,{})},"1"),e.jsx(se.TabPane,{title:t(e.jsx(vs,{style:{fontSize:"20px"}}),"Categories"),children:e.jsx(Hr,{})},"2"),e.jsx(se.TabPane,{title:t(e.jsx(Ss,{style:{fontSize:"20px"}}),"General"),children:e.jsx(Yr,{})},"3"),e.jsx(se.TabPane,{title:t(e.jsx(Cs,{style:{fontSize:"20px"}}),"Appearance"),children:e.jsx(Br,{})},"4"),e.jsx(se.TabPane,{title:t(e.jsx(ks,{style:{fontSize:"20px"}}),"Hotkeys"),children:e.jsx(Qr,{})},"5")]})},en=[{required:!0}],tn=[{required:!0}],sn=[{type:"boolean"}],rn=()=>{const{setSettingsModalVisible:t,settingsModalVisible:s}=ze();return e.jsx(Q,{alignCenter:!1,autoFocus:!1,className:"settings-modal",focusLock:!0,footer:null,onCancel:()=>t(!1),title:null,unmountOnExit:!0,visible:s,children:e.jsx(Zr,{})})},nn=()=>{const t=g(ue),{addFeedModalVisible:s,setAddFeedModalVisible:r}=ze(),[n,a]=p.useState(!1),[i]=P.useForm(),o=async(l,c,d)=>{a(!0);try{await vr(l,c,d),await qe(),b.success("Added a feed successfully"),r(!1),i.resetFields()}catch{b.error("Failed to add a feed")}finally{a(!1)}};return e.jsx(Q,{title:"Add Feed",visible:s,unmountOnExit:!0,style:{width:"400px"},onOk:i.submit,confirmLoading:n,onCancel:()=>{r(!1),i.resetFields()},children:e.jsxs(P,{form:i,labelCol:{span:7},layout:"vertical",wrapperCol:{span:17},onSubmit:async l=>{const c=l.url.trim();c?await o(c,l.category,l.crawler):b.error("Feed URL cannot be empty")},children:[e.jsx(P.Item,{label:"Feed URL",field:"url",rules:en,children:e.jsx(O,{placeholder:"Please input a feed URL"})}),e.jsx(P.Item,{field:"category",label:"Category",required:!0,rules:tn,children:e.jsx($,{placeholder:"Please select a category",showSearch:!0,filterOption:(l,c)=>be(c.props.children,l),children:t.map(l=>e.jsx($.Option,{value:l.id,children:l.title},l.id))})}),e.jsx(P.Item,{field:"crawler",initialValue:!1,label:"Fetch original content",rules:sn,style:{marginBottom:0},triggerPropName:"checked",children:e.jsx(Y,{})})]})})},an=()=>e.jsxs("div",{className:"main",children:[e.jsx(Fs,{}),e.jsx(rn,{}),e.jsx(nn,{})]}),Ht=()=>{const{theme:t,themeColor:s}=g(_),[r,n]=p.useState(window.matchMedia("(prefers-color-scheme: dark)").matches);p.useEffect(()=>{const a=window.matchMedia("(prefers-color-scheme: dark)"),i=o=>n(o.matches);return a.addEventListener("change",i),()=>a.removeEventListener("change",i)},[]),p.useEffect(()=>{const a=i=>{const o=i?"dark":"light";document.body.setAttribute("arco-theme",o),document.body.style.colorScheme=o};zt(s),a(t==="system"?r:t==="dark")},[r,t,s])},on=()=>{Ht();const{isBelowLarge:t}=de();return e.jsxs("div",{className:"app",children:[t?null:e.jsx(Ts.Sider,{breakpoint:"lg",className:"sidebar",collapsible:!1,trigger:null,width:240,children:e.jsx(Vt,{})}),e.jsx(Or,{}),e.jsx(an,{})]})},qt=t=>{const r=new DOMParser().parseFromString(t,"text/html").querySelectorAll("img");return Array.from(r).map(n=>n.getAttribute("src"))},Wt=t=>{var a;const n=(a=new DOMParser().parseFromString(t.content,"text/html").querySelector("img"))==null?void 0:a.getAttribute("src");return{...t,imgSrc:n}},Kt=xt(!1),ct=D(Kt),Ye=()=>{const{offset:t}=g(L),{pageSize:s}=g(_),r=g(Kt),n=i=>{const o=(l,c)=>c.filter(d=>!l.some(h=>h.id===d.id));he(l=>[...l,...o(l,i)]),_t(l=>l+s)};return{handleLoadMore:async i=>{ct(!0);try{const o=await i(t+s);if(o!=null&&o.entries){const l=o.entries.map(Wt);n(l)}}catch(o){console.error("Error fetching more articles: ",o)}finally{ct(!1)}},loadingMore:r}},Xe=Te({isPhotoSliderVisible:!1,selectedIndex:0}),ln=D(Xe,"isPhotoSliderVisible"),cn=D(Xe,"selectedIndex"),Gt=()=>{const{isPhotoSliderVisible:t,selectedIndex:s}=g(Xe);return{isPhotoSliderVisible:t,setIsPhotoSliderVisible:ln,selectedIndex:s,setSelectedIndex:cn}},Yt=t=>{const{activeContent:s}=g(L),r=g(Ge),n=g(Ke),{isPhotoSliderVisible:a,setIsPhotoSliderVisible:i,setSelectedIndex:o}=Gt(),{loadingMore:l}=Ye(),[c,d]=p.useState(!1),[h,m]=p.useState(!1);p.useEffect(()=>{h&&!l&&(d(!1),m(!1),j())},[h,l]),p.useEffect(()=>{if(s){const I=document.querySelector(".card-custom-selected-style");I&&I.scrollIntoView({behavior:"smooth",block:"nearest"})}},[s]);const w=(I,N)=>{var u;s&&(W(null),I.current&&(I.current.setAttribute("tabIndex","-1"),I.current.focus()),(u=N.current)==null||u.scrollTo(0,0))},f=(I=!1)=>{const N=r.findIndex(u=>u.id===(s==null?void 0:s.id));if(N>0){const u=I?r.slice(0,N).toReversed().find(x=>x.status==="unread"):r[N-1];u&&t(u)}},j=(I=!1)=>{var T;if(c)return;const N=r.findIndex(F=>F.id===(s==null?void 0:s.id));if(N===r.length-1&&n){d(!0),m(!0);return}if(N===-1){(T=document.querySelector(".entry-list"))==null||T.scrollTo(0,0);return}const x=I?r.slice(N+1).find(F=>F.status==="unread"):r[N+1];x&&(t(x),m(!1))};return{exitDetailView:w,fetchOriginalArticle:I=>{s&&I()},navigateToNextArticle:j,navigateToPreviousArticle:f,openLinkExternally:()=>{s&&window.open(s.url,"_blank")},openPhotoSlider:()=>{!s||!qt(s.content).length||a||(o(0),i(!0),re(!1))},toggleReadStatus:I=>{s&&I()},toggleStarStatus:I=>{s&&I()}}},dn=({handleEntryClick:t,entryListRef:s,entryDetailRef:r})=>{const{activeContent:n}=g(L),{handleFetchContent:a,handleToggleStarred:i,handleToggleStatus:o}=We(),{exitDetailView:l,navigateToNextArticle:c,navigateToPreviousArticle:d}=Yt(t);if(!n)return null;const h=n.status==="unread",m=n.starred;return e.jsxs(M.Group,{className:"action-buttons",children:[e.jsx(M,{icon:e.jsx(Is,{}),onClick:()=>l(s,r),shape:"round",type:"primary"}),e.jsx(M,{icon:h?e.jsx(bt,{}):e.jsx(wt,{}),onClick:()=>o(n),type:"primary"}),e.jsx(M,{icon:m?e.jsx($e,{style:{color:"#ffcd00"}}):e.jsx(Ue,{}),onClick:()=>i(n),type:"primary"}),e.jsx(M,{icon:e.jsx(As,{}),onClick:()=>d(),type:"primary"}),e.jsx(M,{icon:e.jsx(Es,{}),onClick:()=>c(),type:"primary"}),e.jsx(M,{icon:e.jsx(Ns,{}),onClick:a,shape:"round",type:"primary"})]})},un=({url:t,text:s})=>{const[r,n]=p.useState(!1),a=()=>n(!r);return e.jsx(Ps,{to:t,style:{color:"inherit",textDecoration:r?"underline":"none"},onMouseEnter:a,onMouseLeave:a,children:s})},dt=({node:t,index:s,togglePhotoSlider:r,isLinkWrapper:n=!1})=>{var j;const{fontSize:a}=g(_),[i,o]=p.useState(!1),[l,c]=p.useState(!1),{isBelowMedium:d}=de();p.useEffect(()=>{const U=(n?t.children[0]:t).attribs.src,v=new Image;v.src=U,v.onload=()=>c(v.width<=100&&v.height<=100)},[t,n]);const h=n?t.children[0]:t,m=()=>e.jsx("img",{...h.attribs,alt:h.attribs.alt??"image",style:l?{display:"inline-block",width:"auto",height:`${a}rem`,margin:0}:{}});if(l)return n?e.jsxs("a",{...t.attribs,children:[m(),(j=t.children[1])==null?void 0:j.data]}):m();const w=()=>o(!0),f=()=>o(!1);return e.jsx("div",{style:{textAlign:"center",position:"relative"},children:e.jsxs("div",{style:{display:"inline-block",position:"relative"},onMouseEnter:w,onMouseLeave:f,children:[n?e.jsx("a",{...t.attribs,children:m()}):m(),e.jsx(M,{icon:e.jsx(Ds,{}),shape:"circle",style:{position:"absolute",top:30,right:10,color:"white",backgroundColor:"rgba(0, 0, 0, 0.5)",opacity:d||i?1:0,transition:"opacity 0.3s"},onClick:C=>{C.preventDefault(),r(s)}})]})})},hn=(t,s)=>({replace:r=>{if(r.type==="tag"&&r.name==="a"&&r.children.length>0){const n=r.children[0];if(n.type==="tag"&&n.name==="img"){const a=t.findIndex(i=>i===n.attribs.src);return e.jsx(dt,{node:r,index:a,togglePhotoSlider:s,isLinkWrapper:!0})}}else if(r.type==="tag"&&r.name==="img"){const n=t.findIndex(a=>a===r.attribs.src);return e.jsx(dt,{node:r,index:n,togglePhotoSlider:s})}return r}}),mn=p.forwardRef(({handleEntryClick:t,entryListRef:s},r)=>{const n=ee(),{activeContent:a}=g(L),{articleWidth:i,fontSize:o}=g(_),{isPhotoSliderVisible:l,setIsPhotoSliderVisible:c,selectedIndex:d,setSelectedIndex:h}=Gt(),m=()=>{Fe("author"),ke(a.author)},w=S=>{h(S),c(E=>!E),re(E=>!E)};if(p.useEffect(()=>{var E;const S=(E=r.current)==null?void 0:E.querySelector(".scroll-container");S&&(S.scrollTo(0,0),S.setAttribute("tabIndex","-1"),setTimeout(()=>{S.focus()},200))},[a==null?void 0:a.id]),!a)return e.jsxs("div",{ref:r,className:"content-empty",children:[e.jsx(Rs,{style:{fontSize:"64px"}}),e.jsx(y.Title,{heading:6,style:{color:"var(--color-text-3)",marginTop:"10px"},children:"ReactFlux"})]});const f=qt(a.content),j=hn(f,w),C=Ms(a.content,j),{id:U,title:v}=a.feed.category;return e.jsxs("div",{className:"article-content",onBlur:()=>re(!1),onFocus:()=>re(!0),ref:r,children:[e.jsxs("div",{className:"scroll-container",children:[e.jsxs("div",{className:"article-header",style:{width:`${i}%`},children:[e.jsx(y.Title,{className:"article-title",heading:3,children:e.jsx("a",{href:a.url,target:"_blank",rel:"noopener noreferrer",children:a.title})}),e.jsxs("div",{className:"article-meta",children:[e.jsx(y.Text,{children:e.jsx(un,{url:`/feed/${a.feed.id}`,text:a.feed.title})}),e.jsx(y.Text,{onClick:m,style:{cursor:"pointer"},children:` - ${a.author}`}),e.jsx(y.Text,{children:e.jsx(ce,{size:"small",style:{marginLeft:"10px",cursor:"pointer"},onClick:()=>n(`/category/${U}`),children:v})})]}),e.jsx(y.Text,{className:"article-date",children:B(a.published_at).format("dddd, MMMM D, YYYY [at] h:mm A")}),e.jsx(H,{})]}),e.jsxs("div",{className:"article-body",style:{fontSize:`${o}rem`,width:`${i}%`},children:[C,e.jsx(Ls,{images:f.map(S=>({src:S,key:S})),loop:!1,visible:l,onClose:()=>{c(!1),re(!0)},index:d,onIndexChange:h})]},a.id)]}),e.jsx(dn,{handleEntryClick:t,entryListRef:s,entryDetailRef:r})]})}),fn=({alt:t,borderRadius:s,height:r,src:n,status:a,width:i})=>{const[o,l]=p.useState(!1),{ref:c}=Ae({triggerOnce:!0,onChange:(d,h)=>{if(d&&!o){const m=new Image;m.onload=()=>l(!0),m.onerror=()=>{h.target.style.display="none"},m.src=n}}});return e.jsx("div",{className:"image-container",ref:c,children:e.jsx("div",{className:"img-placeholder",style:{width:"100%",height:"100%",backgroundColor:"var(--color-fill-2)",position:"absolute",left:0,top:0},children:o?e.jsx("img",{className:a==="unread"?"":"read",src:n,alt:t,style:{width:i,height:r,objectFit:"cover",borderRadius:s}}):e.jsx("div",{className:"skeleton-container",children:e.jsx(we,{text:{rows:0},image:{style:{width:i,height:r,margin:"0",borderRadius:s}},animation:!0})})})})},pn=({entry:t,isThumbnail:s})=>{if(!t.imgSrc)return null;const r=s?{width:"80px",height:"80px"}:{width:"100%",height:"160px"};return e.jsx("div",{className:s?"thumbnail":"cover-image",children:e.jsx(fn,{alt:t.id,borderRadius:s?"2px":void 0,src:t.imgSrc,status:t.status,width:r.width,height:r.height})})},gn=({entry:t,showFeedIcon:s,mini:r,children:n})=>{const{showDetailedRelativeTime:a}=g(_),i=Ie({"article-card-mini-content":r,"article-card-mini-content-padding":r&&s});return e.jsxs("div",{className:i,style:{width:"100%",boxSizing:"border-box",opacity:t.status==="unread"?1:.5},children:[e.jsx("div",{style:{padding:t.imgSrc?r?"0 10px 0 0":"0 0 10px 0":"0"},children:e.jsx(pn,{entry:t,isThumbnail:r})}),e.jsxs("div",{className:r?"article-card-mini-content-text":"",children:[e.jsx(y.Text,{className:"article-card-title",children:t.title}),e.jsxs(y.Text,{className:"article-card-info",children:[e.jsx("br",{}),s&&e.jsx(Ut,{feed:t.feed,className:r?"feed-icon-mini":"feed-icon"}),t.feed.title,e.jsx("br",{}),Tt(t.published_at,a)]}),t.starred&&e.jsx($e,{className:"icon-starred"})]}),e.jsx("div",{children:n})]})},xn=({entry:t,handleEntryClick:s,mini:r,children:n})=>{const{markReadOnScroll:a,showFeedIcon:i}=g(_),{activeContent:o}=g(L),l=o&&t.id===o.id,{handleToggleStarred:c,handleToggleStatus:d}=We(),[h,m]=p.useState(0),w=100,f=.5,j=t.starred,C=t.status==="unread",U=_s({preventScrollOnSwipe:!0,delta:w/2,onSwiping:F=>{const A=Math.min(Math.abs(F.deltaX*f),w)*Math.sign(F.deltaX);m(A)},onSwiped:async F=>{try{F.deltaX>w?(await c(t),b.success(j?"Unmarked as starred":"Marked as starred")):F.deltaX<-w&&(await d(t),b.success(C?"Marked as read":"Marked as unread"))}catch{b.error("Failed to update, please try again")}m(0)}}),[v,S]=p.useState(!1),[E,I]=p.useState(!1),N=()=>d(t),u=20,{ref:x}=Ae({skip:E,onChange:async(F,A)=>{if(!(!a||!C)){if(F)S(!0);else if(v){const{top:G}=A.boundingClientRect;G<u&&(await N(),I(!0))}}}}),T=Us({x:h});return p.createElement("div",{...U,className:"article-card",key:t.id},e.jsxs("div",{ref:x,children:[e.jsx($s.div,{className:"swipe-card",style:T,children:e.jsx(Ce,{className:Ie("swipe-content","card-custom-style","card-custom-hover-style",{"card-custom-selected-style":l}),"data-entry-id":t.id,hoverable:!0,onClick:()=>s(t),bordered:!1,children:e.jsx(Ce.Meta,{description:e.jsx(gn,{entry:t,showFeedIcon:i,mini:r,children:n})})})}),e.jsxs("div",{className:"swipe-actions",children:[e.jsx("div",{className:"swipe-action left",children:j?e.jsx($e,{style:{color:"#ffcd00",fontSize:"24px"}}):e.jsx(Ue,{style:{color:"#ffffff",fontSize:"24px"}})}),e.jsx("div",{className:"swipe-action right",children:C?e.jsx(bt,{style:{color:"#ffffff",fontSize:"24px"}}):e.jsx(wt,{style:{color:"#ffffff",fontSize:"24px"}})})]})]}))},yn=()=>{const{layout:t}=g(_),{isArticleListReady:s}=g(L),r=t==="large"?2:4,n=a=>e.jsx(Ce,{className:"card-style",cover:t==="large"?e.jsx("div",{className:"card-cover-style"}):null,children:e.jsx(Ce.Meta,{description:e.jsx(we,{loading:!s,animation:!0,text:{rows:3,width:150}})})},a);return!s&&Array.from({length:r},(a,i)=>n(i))},jn=()=>{const{orderDirection:t}=g(_),{filterString:s,filterType:r}=g(L),{isBelowMedium:n}=de(),a=()=>{q({orderDirection:t==="desc"?"asc":"desc"})};return p.useEffect(()=>{Fe("title"),ke("")},[]),e.jsxs("div",{className:"search-and-sort-bar",children:[e.jsx(O.Search,{allowClear:!0,onChange:ke,placeholder:"Search...",style:{width:n?"100%":278,marginLeft:8},value:s,addBefore:e.jsxs($,{placeholder:"Select type",onChange:Fe,style:{width:100},value:r,children:[e.jsx($.Option,{value:"title",children:"Title"}),e.jsx($.Option,{value:"content",children:"Content"}),e.jsx($.Option,{value:"author",children:"Author"})]})}),e.jsx(le,{mini:!0,content:t==="desc"?"Newest first":"Oldest first",children:e.jsx(M,{shape:"circle",size:"small",style:{margin:"0 8px",flexShrink:0},icon:t==="desc"?e.jsx(Vs,{}):e.jsx(zs,{}),onClick:a})})]})},bn=(...t)=>s=>{for(const r of t)typeof r=="function"?r(s):r&&typeof r=="object"&&(r.current=s)},wn=(t,s,r)=>{p.useLayoutEffect(()=>{let n=null;return t>0&&(clearTimeout(n),n=setTimeout(()=>{r(),clearTimeout(n)},s*4)),()=>clearTimeout(n)},[t,s,r])},vn=({duration:t,color:s})=>{const[r,n]=p.useState([]);wn(r.length,t,()=>{n([])});const a=i=>{const o=i.currentTarget.getBoundingClientRect(),l=o.width>o.height?o.width:o.height,c=i.pageX-o.x-l/2,d=i.pageY-o.y-l/2,h={x:c,y:d,size:l,id:`${new Date().getTime()}-${c}-${d}`};n([...r,h])};return e.jsx("div",{className:"ripple-container",onMouseDown:a,children:r.length>0&&r.map(i=>e.jsx("span",{className:"ripple-span",style:{top:i.y,left:i.x,width:i.size,height:i.size,backgroundColor:s,animationDuration:`${t}ms`}},i.id))})},Sn=({getEntries:t})=>{const{isArticleListReady:s}=g(L),r=g(Ke),{loadingMore:n,handleLoadMore:a}=Ye(),{ref:i}=Ae({skip:!r,onChange:async o=>{!o||!s||n||await a(t)}});return s&&r&&e.jsxs("div",{className:"load-more-container",ref:i,children:[e.jsx(Bs,{loading:n,style:{paddingRight:"10px"}}),"Loading more ..."]})},Cn=p.forwardRef(({getEntries:t,handleEntryClick:s,cardsRef:r},n)=>{const{layout:a,pageSize:i}=g(_),o=a==="small",{isArticleListReady:l}=g(L),c=g(Ge),d=c.length-Math.ceil(i*.2)-1,h=g(Ke),{loadingMore:m,handleLoadMore:w}=Ye(),{ref:f}=Ae({skip:!h,onChange:async v=>{!v||!l||m||await w(t)}}),j=Os({count:c.length,getScrollElement:()=>r.current,estimateSize:()=>o?120:280}),C=j.getVirtualItems(),U=p.useCallback(v=>v===d?bn(j.measureElement,f):j.measureElement,[d,j.measureElement,f]);return e.jsxs(e.Fragment,{children:[e.jsx(jn,{}),e.jsxs("div",{className:"entry-list",ref:n,children:[e.jsx(yn,{}),l&&e.jsx("div",{ref:r,children:e.jsx("div",{style:{height:j.getTotalSize(),width:"100%",position:"relative"},children:C.map(v=>e.jsx("div",{"data-index":v.index,ref:U(v.index),style:{position:"absolute",top:0,left:0,width:"100%",transform:`translateY(${v.start}px)`},children:e.jsx(xn,{entry:c[v.index],handleEntryClick:s,mini:o,children:e.jsx(vn,{color:"var(--color-text-4)",duration:1e3})})},v.key))})}),e.jsx(Sn,{getEntries:t})]})]})}),kn=()=>{he(t=>t.map(s=>({...s,status:"read"})))},Fn=p.forwardRef(({info:t,refreshArticleList:s,markAllAsRead:r},n)=>{const{isArticleListReady:a}=g(L),{showStatus:i}=g(_),o=async()=>{try{await r(),await qe(),kn(),b.success("All articles marked as read")}catch{b.error("Failed to mark all as read")}},l=c=>{n.current&&n.current.scrollTo(0,0),q({showStatus:c})};return p.useEffect(()=>{Fe("title"),ke("")},[i]),e.jsxs("div",{className:"entry-panel",children:[!["starred","history"].includes(t.from)&&e.jsx(jt,{focusLock:!0,title:"Mark All As Read?",onOk:o,children:e.jsx(M,{icon:e.jsx(pt,{}),shape:"circle"})}),e.jsx(Hs.Group,{disabled:t.from==="history",onChange:l,options:[{label:"ALL",value:"all"},{label:"UNREAD",value:"unread"}],type:"button",value:t.from==="history"?"all":i}),e.jsx(M,{icon:e.jsx(Se,{}),loading:!a,shape:"circle",onClick:s})]})}),ae=({info:t,getEntries:s,markAllAsRead:r})=>{const{activeContent:n,isArticleFocused:a,isArticleListReady:i}=g(L),{isAppDataReady:o}=g(z),{orderBy:l,orderDirection:c,showStatus:d}=g(_),h=g(Ge),{handleFetchContent:m,handleToggleStarred:w,handleToggleStatus:f,handleEntryStatusUpdate:j}=We(),[C,U]=p.useState(!1),v=p.useRef(null),S=p.useRef(null),E=p.useRef(null);p.useEffect(()=>{!C||["starred","history"].includes(t.from)||X()},[l]),p.useEffect(()=>{_r(t.from),X()},[t]),p.useEffect(()=>{X()},[c,d]);const I=async R=>{if(W(null),R.status!=="unread"){setTimeout(()=>{W({...R,status:"read"})},200);return}try{setTimeout(()=>{W({...R,status:"read"}),j(R,"read")},200),await Ee([R.id],"read")}catch{b.error("Failed to mark entry as read, please try again later"),j(R,"unread")}},{exitDetailView:N,fetchOriginalArticle:u,navigateToNextArticle:x,navigateToPreviousArticle:T,openLinkExternally:F,openPhotoSlider:A,toggleReadStatus:G,toggleStarStatus:te}=Yt(I);p.useEffect(()=>{const R={ArrowLeft:()=>T(),ArrowRight:()=>x(),Escape:()=>N(v,E),b:F,d:()=>u(m),m:()=>G(()=>f(n)),s:()=>te(()=>w(n)),v:A},ie=oe=>{const Je=R[oe.key];Je&&(oe.key==="ArrowLeft"?T(oe.ctrlKey):oe.key==="ArrowRight"?x(oe.ctrlKey):Je())};return a?document.addEventListener("keydown",ie):document.removeEventListener("keydown",ie),()=>{document.removeEventListener("keydown",ie)}},[n,h,a]);const me=R=>{if((R==null?void 0:R.total)>=0){const ie=R.entries.map(Wt);he(ie),Ur(R.total)}},fe=async()=>{at(!1);try{const R=d==="unread"?await s(0,"unread"):await s();me(R)}catch(R){console.error("Error fetching articles: ",R)}finally{at(!0)}},X=async()=>{var R;if((R=v.current)==null||R.scrollTo(0,0),_t(0),!o){await qe();return}await fe()};return p.useEffect(()=>{n&&W(null)},[]),p.useEffect(()=>{if(!o)try{fe(),U(!0),re(!0)}catch{b.error("Failed to fetch articles, please try again later")}},[o]),e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"entry-col",children:[e.jsx(st,{in:i,timeout:200,nodeRef:S,classNames:"fade",children:e.jsx(Cn,{cardsRef:S,getEntries:s,handleEntryClick:I,ref:v})}),e.jsx(Fn,{info:t,refreshArticleList:X,markAllAsRead:r,ref:v})]}),e.jsx(st,{in:n!==null,timeout:200,nodeRef:E,classNames:"fade",unmountOnExit:!0,children:e.jsx(mn,{handleEntryClick:I,entryListRef:v,ref:E})})]})},Tn=()=>e.jsx(ae,{info:{from:"all",id:""},getEntries:xr,markAllAsRead:Tr}),In=()=>{const{id:t}=vt(),s=V("orderBy"),r=V("pageSize"),n=V("showAllFeeds"),a=async(i=0,o=null)=>{const l={baseUrl:`/v1/categories/${t}/entries`,orderField:s,offset:i,limit:r,status:o},c={globally_visible:!n};return k.get(ne(l,c))};return e.jsx(ae,{info:{from:"category",id:t},getEntries:a,markAllAsRead:()=>dr(t)})},An=()=>{const t=ee(),s=qs();return console.error(s),e.jsx("div",{id:"error-page",style:{top:"30%",position:"relative"},children:e.jsx(Ws,{status:"404",subTitle:s.statusText||s.message,extra:[e.jsx(M,{type:"primary",onClick:()=>t("/"),children:"Back to Home"},"back")]})})},En=()=>{const{id:t}=vt(),s=V("orderBy"),r=V("pageSize"),n=async(a=0,i=null)=>{const o={baseUrl:`/v1/feeds/${t}/entries`,orderField:s,offset:a,limit:r,status:i};return k.get(ne(o))};return e.jsx(ae,{info:{from:"feed",id:t},getEntries:n,markAllAsRead:()=>Cr(t)})},Nn=()=>e.jsx(ae,{info:{from:"history",id:""},getEntries:At}),Rn="/assets/background-BMolBQF-.jpg",Mn=t=>{const s=t.getFieldsValue();let r=!0;for(const[n,a]of Object.entries(s))if(n!=="password"){const i=a==null?void 0:a.trim();t.setFieldValue(n,i),i||(r=!1)}else a||(r=!1);return r},xe=(t,s)=>{t.key==="Enter"&&s.submit()},Ln=()=>{Ht();const[t]=Ks(),[s,r]=p.useState(!1),[n,a]=p.useState("token"),i=ee(),o=async()=>{r(!0);const{server:c,token:d,username:h,password:m}=t.getFieldsValue();try{(await ht.raw("v1/me",{baseURL:c,headers:d?{"X-Auth-Token":d}:{Authorization:`Basic ${btoa(`${h}:${m}`)}`}})).status===200&&(b.success("Login successfully"),kt({server:c,token:d,username:h,password:m}),i("/"))}catch(w){console.error(w),b.error(w.message)}r(!1)},l=async()=>{const c=t.getFieldsValue();if(!Be(c)){b.error("Please check your server address and credentials");return}await o()};return e.jsxs("div",{className:"page-layout",style:{height:"100%",display:"flex"},children:[e.jsx("div",{className:"form-panel",style:{backgroundColor:"var(--color-bg-1)",width:"50%",height:"100%",display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",overflowY:"auto",zIndex:2},children:e.jsxs("div",{className:"login-form",style:{width:"340px"},children:[e.jsx(y.Title,{heading:3,children:"Connect to your server"}),e.jsxs(P,{autoComplete:"off",form:t,layout:"vertical",onSubmit:async()=>{Mn(t)?await l():b.error("Please fill in all required fields")},children:[e.jsx(P.Item,{field:"server",label:"Server address",rules:[{required:!0}],onKeyDown:c=>{xe(c,t)},children:e.jsx(O,{disabled:s,placeholder:"Please input server address",prefix:e.jsx(Gs,{})})}),n==="token"&&e.jsx(P.Item,{field:"token",label:"API Token",rules:[{required:!0}],onKeyDown:c=>{xe(c,t)},children:e.jsx(O.Password,{disabled:s,placeholder:"Please input API token",prefix:e.jsx(rt,{})})}),n==="user"&&e.jsxs(e.Fragment,{children:[e.jsx(P.Item,{field:"username",label:"Username",rules:[{required:!0}],onKeyDown:c=>{xe(c,t)},children:e.jsx(O,{disabled:s,placeholder:"Please input username",prefix:e.jsx(gt,{})})}),e.jsx(P.Item,{field:"password",label:"Password",rules:[{required:!0}],onKeyDown:c=>{xe(c,t)},children:e.jsx(O.Password,{disabled:s,placeholder:"Please input password",prefix:e.jsx(rt,{})})})]})]}),e.jsx(M,{loading:s,type:"primary",long:!0,onClick:()=>t.submit(),style:{marginTop:"20px"},children:"Connect"}),e.jsx(H,{orientation:"center",children:"Or connect with"}),e.jsx(M,{type:"secondary",long:!0,onClick:()=>a(n==="token"?"user":"token"),style:{marginTop:"20px"},children:n==="token"?"Username and password":"API Token"}),e.jsxs("div",{style:{display:"flex",marginTop:"40px"},children:[e.jsx(y.Text,{disabled:!0,children:"Need more info?"}),e.jsx(Ys,{href:"https://miniflux.app/docs/api.html#authentication",style:{fontWeight:"500"},children:"Go to Miniflux official website"})]})]})}),e.jsx("div",{className:"background",style:{backgroundImage:`url(${Rn})`,backgroundSize:"cover",backgroundPosition:"center",backgroundRepeat:"no-repeat",width:"50%",height:"100%"}})]})},Pn=({children:t})=>{const s=g(Oe);return Be(s)?e.jsx(e.Fragment,{children:t}):e.jsx(St,{to:"/login"})},Dn=()=>e.jsx(ae,{info:{from:"starred",id:""},getEntries:It}),_n=()=>{const t=async()=>{const s=await ye(0,"unread"),r=s.total;let n=s.entries;r>n.length&&(n=ye(0,"unread",r).then(i=>i.entries));const a=n.map(i=>i.id);return Ee(a,"read")};return e.jsx(ae,{info:{from:"today",id:""},getEntries:ye,markAllAsRead:t})},Un=V("homePage"),$n=[{path:"/all",element:e.jsx(Tn,{})},{path:"/today",element:e.jsx(_n,{})},{path:"/starred",element:e.jsx(Dn,{})},{path:"/history",element:e.jsx(Nn,{})},{path:"/category/:id",element:e.jsx(In,{})},{path:"/feed/:id",element:e.jsx(En,{})}],Xt=Xs([{path:"/",element:e.jsx(Pn,{children:e.jsx(on,{})}),errorElement:e.jsx(An,{}),children:[...$n,{index:!0,element:e.jsx(St,{to:`/${Un}`,replace:!0})}]},{path:"/login",element:e.jsx(Ln,{})}]);Js.createRoot(document.getElementById("root")).render(e.jsx(Qs,{locale:Zs,children:e.jsx(er,{router:Xt})}));
